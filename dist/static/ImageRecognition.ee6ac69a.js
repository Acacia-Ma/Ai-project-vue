var a=Object.defineProperty,e=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,s=(e,l,t)=>l in e?a(e,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[l]=t;import{m as i,d as n,c as o,h as r}from"./element-plus.e5f0d4bb.js";import{e as u,o as c,f as d}from"./model.c745ba67.js";import{K as m,L as v,ap as p,aq as y,a0 as b,r as f,E as g,T as _,aj as h,S as w,V as j,$ as x,W as O,_ as S,Z as k}from"./@vue.55e6b646.js";import{a as V}from"./index.f2dd9c25.js";const D={},I=a=>(p("data-v-662077cb"),a=a(),y(),a),C={class:"loading"},L=[I((()=>b("div",null,null,-1))),I((()=>b("div",null,null,-1))),I((()=>b("div",null,null,-1)))];D.render=function(a,e){return m(),v("div",C,L)},D.__scopeId="data-v-662077cb";const P=a=>(p("data-v-b3e097ae"),a=a(),y(),a),E={class:"image-recognition-container"},T={class:"layout-container"},U={class:"history-panel"},q=P((()=>b("div",{class:"title"},"识别历史",-1))),z={class:"history-list"},F=["onClick"],K=["src"],M={class:"history-details"},R={class:"history-name"},W={class:"history-time"},Z={class:"image-panel"},$={class:"upload-panel"},A=P((()=>b("i",{class:"el-icon-plus"},null,-1))),B={key:0,class:"recognition-action"},G={key:1,class:"recognition-panel"},H={class:"result-box"},J=["src"],N={__name:"ImageRecognition",setup(a){const p=f(""),y=f(!1),I=f([]),C=f(""),L=f([]),P=f(null),N=f(!1),Q=async a=>{let e=new FormData;e.append("file",a.raw);try{const l=await u(e),t=V().base_url+"/imgadownload/"+l.data.filename;p.value=t,C.value=l.data.filename,I.value=[{name:a.raw.name,url:t}],P.value={id:Date.now(),name:C.value,text:"",thumbnail:t,time:(new Date).toLocaleString()}}catch(l){p.value=null,C.value="",I.value=[]}};g((async()=>{try{const a=await c();L.value=a.data.map((a=>({id:a.img_id,name:a.name,text:a.content,thumbnail:V().base_url+"/imgadownload/"+a.name,time:a.created_at})))}catch(a){}}));const X=async()=>{if(C.value){N.value=!0;try{const a={image_name:C.value,id:Date.now(),create_time:(new Date).toISOString()},i=await d(a);P.value={id:a.id,name:C.value,text:i.data.text,thumbnail:p.value,time:(new Date).toLocaleString()},L.value.push(((a,i)=>{for(var n in i||(i={}))l.call(i,n)&&s(a,n,i[n]);if(e)for(var n of e(i))t.call(i,n)&&s(a,n,i[n]);return a})({},P.value))}catch(a){}finally{N.value=!1}}};return(a,e)=>{const l=i,t=n,s=o,u=r;return m(),v("div",E,[b("div",T,[b("div",U,[q,b("div",z,[(m(!0),v(_,null,h(L.value,(a=>(m(),v("div",{key:a.id,class:"history-item",onClick:e=>(a=>{P.value=a})(a)},[b("img",{src:a.thumbnail,class:"history-thumbnail"},null,8,K),b("div",M,[b("div",R,S(a.name),1),b("div",W,S(a.time),1)])],8,F)))),128))])]),b("div",Z,[b("div",$,[w(l,{class:"image-uploader","on-change":Q,"on-preview":()=>{y.value=!0},"auto-upload":!1,"list-type":"picture-card","file-list":I.value},{default:j((()=>[A])),_:1},8,["on-preview","file-list"])]),p.value?(m(),v("div",B,[w(t,{type:"primary",onClick:X},{default:j((()=>[k("识别图片")])),_:1})])):x("",!0),P.value?(m(),v("div",G,[b("div",H,[w(s,{type:"textarea",placeholder:"识别结果",modelValue:P.value.text,"onUpdate:modelValue":e[0]||(e[0]=a=>P.value.text=a),rows:10,readonly:""},null,8,["modelValue"]),N.value?(m(),O(D,{key:0})):x("",!0)])])):x("",!0),w(u,{modelValue:y.value,"onUpdate:modelValue":e[1]||(e[1]=a=>y.value=a)},{default:j((()=>[b("img",{src:p.value,class:"full-image"},null,8,J)])),_:1},8,["modelValue"])])])])}},__scopeId:"data-v-b3e097ae"};var Q=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:N});export{Q as I,D as _,N as a};
