{
  "version": 3,
  "sources": ["../recorder-core/src/recorder-core.js", "dep:recorder-core"],
  "sourcesContent": ["/*\n\u5F55\u97F3\nhttps://github.com/xiangyuecn/Recorder\n*/\n(function(factory){\n\tvar browser=typeof window==\"object\" && !!window.document;\n\tvar win=browser?window:Object; //\u975E\u6D4F\u89C8\u5668\u73AF\u5883\uFF0CRecorder\u6302\u8F7D\u5728Object\u4E0B\u9762\n\tfactory(win,browser);\n\t//umd returnExports.js\n\tif(typeof(define)=='function' && define.amd){\n\t\tdefine(function(){\n\t\t\treturn win.Recorder;\n\t\t});\n\t};\n\tif(typeof(module)=='object' && module.exports){\n\t\tmodule.exports=win.Recorder;\n\t};\n}(function(Export,isBrowser){\n\"use strict\";\n\nvar NOOP=function(){};\nvar IsNum=function(v){return typeof v==\"number\"};\n\nvar Recorder=function(set){\n\treturn new initFn(set);\n};\nvar LM=Recorder.LM=\"2024-04-09 19:15\";\nvar GitUrl=\"https://github.com/xiangyuecn/Recorder\";\nvar RecTxt=\"Recorder\";\nvar getUserMediaTxt=\"getUserMedia\";\nvar srcSampleRateTxt=\"srcSampleRate\";\nvar sampleRateTxt=\"sampleRate\";\nvar bitRateTxt=\"bitRate\";\nvar CatchTxt=\"catch\";\n\nvar WRec2=Export[RecTxt];//\u91CD\u590D\u52A0\u8F7Djs\nif(WRec2&&WRec2.LM==LM){\n\tWRec2.CLog(WRec2.i18n.$T(\"K8zP::\u91CD\u590D\u5BFC\u5165{1}\",0,RecTxt),3);\n\treturn;\n};\n\n\n//\u662F\u5426\u5DF2\u7ECF\u6253\u5F00\u4E86\u5168\u5C40\u7684\u9EA6\u514B\u98CE\u5F55\u97F3\uFF0C\u6240\u6709\u5DE5\u4F5C\u90FD\u5DF2\u7ECF\u51C6\u5907\u597D\u4E86\uFF0C\u5C31\u7B49\u63A5\u6536\u97F3\u9891\u6570\u636E\u4E86\nRecorder.IsOpen=function(){\n\tvar stream=Recorder.Stream;\n\tif(stream){\n\t\tvar tracks=stream.getTracks&&stream.getTracks()||stream.audioTracks||[];\n\t\tvar track=tracks[0];\n\t\tif(track){\n\t\t\tvar state=track.readyState;\n\t\t\treturn state==\"live\"||state==track.LIVE;\n\t\t};\n\t};\n\treturn false;\n};\n/*H5\u5F55\u97F3\u65F6\u7684AudioContext\u7F13\u51B2\u5927\u5C0F\u3002\u4F1A\u5F71\u54CDH5\u5F55\u97F3\u65F6\u7684onProcess\u8C03\u7528\u901F\u7387\uFF0C\u76F8\u5BF9\u4E8EAudioContext.sampleRate=48000\u65F6\uFF0C4096\u63A5\u8FD112\u5E27/s\uFF0C\u8C03\u8282\u6B64\u53C2\u6570\u53EF\u751F\u6210\u6BD4\u8F83\u6D41\u7545\u7684\u56DE\u8C03\u52A8\u753B\u3002\n\t\u53D6\u503C256, 512, 1024, 2048, 4096, 8192, or 16384\n\t\u6CE8\u610F\uFF0C\u53D6\u503C\u4E0D\u80FD\u8FC7\u4F4E\uFF0C2048\u5F00\u59CB\u4E0D\u540C\u6D4F\u89C8\u5668\u53EF\u80FD\u56DE\u8C03\u901F\u7387\u8DDF\u4E0D\u4E0A\u9020\u6210\u97F3\u8D28\u95EE\u9898\u3002\n\t\u4E00\u822C\u65E0\u9700\u8C03\u6574\uFF0C\u8C03\u6574\u540E\u9700\u8981\u5148close\u6389\u5DF2\u6253\u5F00\u7684\u5F55\u97F3\uFF0C\u518Dopen\u65F6\u624D\u4F1A\u751F\u6548\u3002\n*/\nRecorder.BufferSize=4096;\n//\u9500\u6BC1\u5DF2\u6301\u6709\u7684\u6240\u6709\u5168\u5C40\u8D44\u6E90\uFF0C\u5F53\u8981\u5F7B\u5E95\u79FB\u9664Recorder\u65F6\u9700\u8981\u663E\u5F0F\u7684\u8C03\u7528\u6B64\u65B9\u6CD5\nRecorder.Destroy=function(){\n\tCLog(RecTxt+\" Destroy\");\n\tDisconnect();//\u65AD\u5F00\u53EF\u80FD\u5B58\u5728\u7684\u5168\u5C40Stream\u3001\u8D44\u6E90\n\t\n\tfor(var k in DestroyList){\n\t\tDestroyList[k]();\n\t};\n};\nvar DestroyList={};\n//\u767B\u8BB0\u4E00\u4E2A\u9700\u8981\u9500\u6BC1\u5168\u5C40\u8D44\u6E90\u7684\u5904\u7406\u65B9\u6CD5\nRecorder.BindDestroy=function(key,call){\n\tDestroyList[key]=call;\n};\n//\u5224\u65AD\u6D4F\u89C8\u5668\u662F\u5426\u652F\u6301\u5F55\u97F3\uFF0C\u968F\u65F6\u53EF\u4EE5\u8C03\u7528\u3002\u6CE8\u610F\uFF1A\u4EC5\u4EC5\u662F\u68C0\u6D4B\u6D4F\u89C8\u5668\u652F\u6301\u60C5\u51B5\uFF0C\u4E0D\u4F1A\u5224\u65AD\u548C\u8C03\u8D77\u7528\u6237\u6388\u6743\uFF0C\u4E0D\u4F1A\u5224\u65AD\u662F\u5426\u652F\u6301\u7279\u5B9A\u683C\u5F0F\u5F55\u97F3\u3002\nRecorder.Support=function(){\n\tif(!isBrowser) return false;\n\tvar scope=navigator.mediaDevices||{};\n\tif(!scope[getUserMediaTxt]){\n\t\tscope=navigator;\n\t\tscope[getUserMediaTxt]||(scope[getUserMediaTxt]=scope.webkitGetUserMedia||scope.mozGetUserMedia||scope.msGetUserMedia);\n\t};\n\tif(!scope[getUserMediaTxt]){\n\t\treturn false;\n\t};\n\tRecorder.Scope=scope;\n\t\n\tif(!Recorder.GetContext()){\n\t\treturn false;\n\t};\n\treturn true;\n};\n//\u83B7\u53D6\u5168\u5C40\u7684AudioContext\u5BF9\u8C61\uFF0C\u5982\u679C\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u5C06\u8FD4\u56DEnull\u3002tryNew\u65F6\u5C1D\u8BD5\u521B\u5EFA\u65B0\u7684\u975E\u5168\u5C40\u5BF9\u8C61\u5E76\u8FD4\u56DE\uFF0C\u5931\u8D25\u65F6\u4F9D\u65E7\u8FD4\u56DE\u5168\u5C40\u7684\uFF1B\u6210\u529F\u65F6\u8FD4\u56DE\u65B0\u7684\uFF0C\u6CE8\u610F\u7528\u5B8C\u5FC5\u987B\u81EA\u5DF1\u8C03\u7528CloseNewCtx(ctx)\u5173\u95ED\u3002\u6CE8\u610F\uFF1A\u975E\u7528\u6237\u64CD\u4F5C\uFF08\u89E6\u6478\u3001\u70B9\u51FB\u7B49\uFF09\u65F6\u8C03\u7528\u8FD4\u56DE\u7684ctx.state\u53EF\u80FD\u662Fsuspended\u72B6\u6001\uFF0C\u9700\u8981\u5728\u7528\u6237\u64CD\u4F5C\u65F6\u8C03\u7528ctx.resume\u6062\u590D\u6210running\u72B6\u6001\uFF0C\u53C2\u8003rec\u7684runningContext\u914D\u7F6E\nRecorder.GetContext=function(tryNew){\n\tif(!isBrowser) return null;\n\tvar AC=window.AudioContext;\n\tif(!AC){\n\t\tAC=window.webkitAudioContext;\n\t};\n\tif(!AC){\n\t\treturn null;\n\t};\n\t\n\tvar ctx=Recorder.Ctx;\n\tif(!ctx||ctx.state==\"closed\"){\n\t\t//\u4E0D\u80FD\u53CD\u590D\u6784\u9020\uFF0C\u4F4E\u7248\u672Cnumber of hardware contexts reached maximum (6)\n\t\tctx=Recorder.Ctx=new AC();\n\t\tRecorder.NewCtxs=Recorder.NewCtxs||[];\n\t\t\n\t\tRecorder.BindDestroy(\"Ctx\",function(){\n\t\t\tvar ctx=Recorder.Ctx;\n\t\t\tif(ctx&&ctx.close){//\u80FD\u5173\u6389\u5C31\u5173\u6389\uFF0C\u5173\u4E0D\u6389\u5C31\u4FDD\u7559\u7740\n\t\t\t\tCloseCtx(ctx);\n\t\t\t\tRecorder.Ctx=0;\n\t\t\t};\n\t\t\tvar arr=Recorder.NewCtxs; Recorder.NewCtxs=[];\n\t\t\tfor(var i=0;i<arr.length;i++)CloseCtx(arr[i]);\n\t\t});\n\t};\n\tif(tryNew && ctx.close){//\u6CA1\u6CD5\u5173\u95ED\u7684\u4E0D\u5141\u8BB8\u518D\u521B\u5EFA\n\t\ttry{\n\t\t\tctx=new AC();\n\t\t\tRecorder.NewCtxs.push(ctx);\n\t\t}catch(e){\n\t\t\tCLog(\"GetContext tryNew Error\",1,e);\n\t\t}\n\t};\n\treturn ctx;\n};\n//\u5173\u95ED\u65B0\u521B\u5EFA\u7684AudioContext\uFF0C\u5982\u679C\u662F\u5168\u5C40\u7684\u4E0D\u5173\u95ED\nRecorder.CloseNewCtx=function(ctx){\n\tif(ctx && ctx!=Recorder.Ctx){\n\t\tCloseCtx(ctx);\n\t\tvar arr=Recorder.NewCtxs||[],L=arr.length;\n\t\tfor(var i=0;i<arr.length;i++){\n\t\t\tif(arr[i]==ctx){ arr.splice(i,1); break; }\n\t\t}\n\t\tCLog($T(\"mSxV::\u5269{1}\u4E2AGetContext\u672Aclose\",0,L+\"-1=\"+arr.length),arr.length?3:0);\n\t}\n};\nvar CloseCtx=function(ctx){\n\tif(ctx && ctx.close){\n\t\tctx._isC=1;\n\t\ttry{ ctx.close() }catch(e){ CLog(\"ctx close err\",1,e) }\n\t}\n};\n//\u5F53AudioContext\u7684\u72B6\u6001\u662Fsuspended\u65F6\uFF0C\u8C03\u7528resume\u6062\u590D\u72B6\u6001\uFF0C\u4F46\u5982\u679C\u6CA1\u6709\u7528\u6237\u64CD\u4F5Cresume\u53EF\u80FD\u6CA1\u6709\u56DE\u8C03\uFF0C\u5C01\u88C5\u89E3\u51B3\u6B64\u56DE\u8C03\u95EE\u9898\uFF1Bcheck(count)\u8FD4\u56DEtrue\u7EE7\u7EED\u5C1D\u8BD5resume\uFF0C\u8FD4\u56DEfalse\u7EC8\u6B62\u4EFB\u52A1\uFF08\u4E0D\u56DE\u8C03False\uFF09\nvar ResumeCtx=Recorder.ResumeCtx=function(ctx,check,True,False){\n\tvar isEnd=0,isBind=0,isLsSC=0,runC=0,EL=\"EventListener\",Tag=\"ResumeCtx \";\n\tvar end=function(err,ok){\n\t\tif(isBind){ bind() }\n\t\tif(!isEnd){ isEnd=1; //\u56DE\u8C03\u7ED3\u679C\n\t\t\terr&&False(err,runC);\n\t\t\tok&&True(runC);\n\t\t}\n\t\tif(ok){ //\u76D1\u542C\u540E\u7EED\u72B6\u6001\u53D8\u5316\n\t\t\tif(!ctx._LsSC && ctx[\"add\"+EL]) ctx[\"add\"+EL](\"statechange\",run);\n\t\t\tctx._LsSC=1; isLsSC=1;\n\t\t}\n\t};\n\tvar bind=function(add){\n\t\tif(add && isBind) return; isBind=add?1:0;\n\t\tvar types=[\"focus\",\"mousedown\",\"mouseup\",\"touchstart\",\"touchend\"];\n\t\tfor(var i=0;i<types.length;i++)\n\t\t\twindow[(add?\"add\":\"remove\")+EL](types[i],run,true);\n\t};\n\tvar run=function(){\n\t\tvar sVal=ctx.state,spEnd=CtxSpEnd(sVal);\n\t\tif(!isEnd && !check(spEnd?++runC:runC))return end(); //\u7EC8\u6B62\uFF0C\u4E0D\u56DE\u8C03\n\t\tif(spEnd){\n\t\t\tif(isLsSC)CLog(Tag+\"sc \"+sVal,3);\n\t\t\tbind(1); //\u7ED1\u5B9A\u7528\u6237\u4E8B\u4EF6\u5C1D\u8BD5\u6062\u590D\n\t\t\tctx.resume().then(function(){ //resume\u56DE\u8C03\u4E0D\u53EF\u9760\n\t\t\t\tif(isLsSC)CLog(Tag+\"sc \"+ctx.state);\n\t\t\t\tend(0,1);\n\t\t\t})[CatchTxt](function(e){ //\u51FA\u9519\u4E14\u65E0\u6CD5\u6062\u590D\n\t\t\t\tCLog(Tag+\"error\",1,e);\n\t\t\t\tif(!CtxSpEnd(ctx.state)){\n\t\t\t\t\tend(e.message||\"error\");\n\t\t\t\t}\n\t\t\t});\n\t\t}else if(sVal==\"closed\"){\n\t\t\tif(isLsSC && !ctx._isC)CLog(Tag+\"sc \"+sVal,1); //\u65E0\u6CD5\u6062\u590D\uFF0C\u6253\u4E2A\u65E5\u5FD7\n\t\t\tend(\"ctx closed\");\n\t\t}else{ end(0,1) }; //running \u6216\u8001\u7684\u65E0state\n\t};\n\trun();\n};\nvar CtxSpEnd=Recorder.CtxSpEnd=function(v){\n\treturn v==\"suspended\"||v==\"interrupted\"; //\u540E\u9762\u8FD9\u4E2A\u4EC5iOS\u6709\n};\nvar CtxState=function(ctx){\n\tvar v=ctx.state,msg=\"ctx.state=\"+v;\n\tif(CtxSpEnd(v))msg+=$T(\"nMIy::\uFF08\u6CE8\u610F\uFF1Actx\u4E0D\u662Frunning\u72B6\u6001\uFF0Crec.open\u548Cstart\u81F3\u5C11\u8981\u6709\u4E00\u4E2A\u5728\u7528\u6237\u64CD\u4F5C(\u89E6\u6478\u3001\u70B9\u51FB\u7B49)\u65F6\u8FDB\u884C\u8C03\u7528\uFF0C\u5426\u5219\u5C06\u5728rec.start\u65F6\u5C1D\u8BD5\u8FDB\u884Cctx.resume\uFF0C\u53EF\u80FD\u4F1A\u4EA7\u751F\u517C\u5BB9\u6027\u95EE\u9898(\u4EC5iOS)\uFF0C\u8BF7\u53C2\u9605\u6587\u6863\u4E2DrunningContext\u914D\u7F6E\uFF09\");\n\treturn msg;\n};\n\n\n/*\u662F\u5426\u542F\u7528MediaRecorder.WebM.PCM\u6765\u8FDB\u884C\u97F3\u9891\u91C7\u96C6\u8FDE\u63A5\uFF08\u5982\u679C\u6D4F\u89C8\u5668\u652F\u6301\u7684\u8BDD\uFF09\uFF0C\u9ED8\u8BA4\u542F\u7528\uFF0C\u7981\u7528\u6216\u8005\u4E0D\u652F\u6301\u65F6\u5C06\u4F7F\u7528AudioWorklet\u6216ScriptProcessor\u6765\u8FDE\u63A5\uFF1BMediaRecorder\u91C7\u96C6\u5230\u7684\u97F3\u9891\u6570\u636E\u6BD4\u5176\u4ED6\u65B9\u5F0F\u66F4\u597D\uFF0C\u51E0\u4E4E\u4E0D\u5B58\u5728\u4E22\u5E27\u73B0\u8C61\uFF0C\u6240\u4EE5\u97F3\u8D28\u660E\u663E\u4F1A\u597D\u5F88\u591A\uFF0C\u5EFA\u8BAE\u4FDD\u6301\u5F00\u542F*/\nvar ConnectEnableWebM=\"ConnectEnableWebM\";\nRecorder[ConnectEnableWebM]=true;\n\n/*\u662F\u5426\u542F\u7528AudioWorklet\u7279\u6027\u6765\u8FDB\u884C\u97F3\u9891\u91C7\u96C6\u8FDE\u63A5\uFF08\u5982\u679C\u6D4F\u89C8\u5668\u652F\u6301\u7684\u8BDD\uFF09\uFF0C\u9ED8\u8BA4\u7981\u7528\uFF0C\u7981\u7528\u6216\u4E0D\u652F\u6301\u65F6\u5C06\u4F7F\u7528\u8FC7\u65F6\u7684ScriptProcessor\u6765\u8FDE\u63A5\uFF08\u5982\u679C\u65B9\u6CD5\u8FD8\u5728\u7684\u8BDD\uFF09\uFF0C\u5F53\u524DAudioWorklet\u7684\u5B9E\u73B0\u5728\u79FB\u52A8\u7AEF\u6CA1\u6709ScriptProcessor\u7A33\u5065\uFF1BConnectEnableWebM\u5982\u679C\u542F\u7528\u5E76\u4E14\u6709\u6548\u65F6\uFF0C\u672C\u53C2\u6570\u5C06\u4E0D\u8D77\u4F5C\u7528*/\nvar ConnectEnableWorklet=\"ConnectEnableWorklet\";\nRecorder[ConnectEnableWorklet]=false;\n\n/*\u521D\u59CB\u5316H5\u97F3\u9891\u91C7\u96C6\u8FDE\u63A5\u3002\u5982\u679C\u81EA\u884C\u63D0\u4F9B\u4E86sourceStream\u5C06\u53EA\u8FDB\u884C\u4E00\u6B21\u7B80\u5355\u7684\u8FDE\u63A5\u5904\u7406\u3002\u5982\u679C\u662F\u666E\u901A\u9EA6\u514B\u98CE\u5F55\u97F3\uFF0C\u6B64\u65F6\u7684Stream\u662F\u5168\u5C40\u7684\uFF0CSafari\u4E0A\u65AD\u5F00\u540E\u5C31\u65E0\u6CD5\u518D\u6B21\u8FDB\u884C\u8FDE\u63A5\u4F7F\u7528\uFF0C\u8868\u73B0\u4E3A\u9759\u97F3\uFF0C\u56E0\u6B64\u4F7F\u7528\u5168\u90E8\u4F7F\u7528\u5168\u5C40\u5904\u7406\u907F\u514D\u8C03\u7528\u5230disconnect\uFF1B\u5168\u5C40\u5904\u7406\u4E5F\u6709\u5229\u4E8E\u5C4F\u853D\u5E95\u5C42\u7EC6\u8282\uFF0Cstart\u65F6\u65E0\u9700\u518D\u8C03\u7528\u5E95\u5C42\u63A5\u53E3\uFF0C\u63D0\u5347\u517C\u5BB9\u3001\u53EF\u9760\u6027\u3002*/\nvar Connect=function(streamStore,isUserMedia){\n\tvar bufferSize=streamStore.BufferSize||Recorder.BufferSize;\n\t\n\tvar stream=streamStore.Stream;\n\tvar ctx=stream._RC || stream._c || Recorder.GetContext(true);//2023-06 \u5C3D\u91CF\u521B\u5EFA\u65B0\u7684ctx\uFF0C\u514D\u5F97Safari\u518D\u6B21\u8FDE\u63A5\u65E0\u56DE\u8C03\n\tstream._c=ctx;\n\t\n\tvar mediaConn=function(node){\n\t\tvar media=stream._m=ctx.createMediaStreamSource(stream);\n\t\tvar ctxDest=ctx.destination,cmsdTxt=\"createMediaStreamDestination\";\n\t\tif(ctx[cmsdTxt]){\n\t\t\tctxDest=stream._d=ctx[cmsdTxt]();\n\t\t};\n\t\tmedia.connect(node);\n\t\tnode.connect(ctxDest);\n\t}\n\tvar isWebM,isWorklet,badInt,webMTips=\"\";\n\tvar calls=stream._call;\n\t\n\t//\u6D4F\u89C8\u5668\u56DE\u4F20\u7684\u97F3\u9891\u6570\u636E\u5904\u7406\n\tvar onReceive=function(float32Arr){\n\t\tfor(var k0 in calls){//has item\n\t\t\tvar size=float32Arr.length;\n\t\t\t\n\t\t\tvar pcm=new Int16Array(size);\n\t\t\tvar sum=0;\n\t\t\tfor(var j=0;j<size;j++){//floatTo16BitPCM \n\t\t\t\tvar s=Math.max(-1,Math.min(1,float32Arr[j]));\n\t\t\t\ts=s<0?s*0x8000:s*0x7FFF;\n\t\t\t\tpcm[j]=s;\n\t\t\t\tsum+=Math.abs(s);\n\t\t\t};\n\t\t\t\n\t\t\tfor(var k in calls){\n\t\t\t\tcalls[k](pcm,sum);\n\t\t\t};\n\t\t\t\n\t\t\treturn;\n\t\t};\n\t};\n\t\n\tvar scriptProcessor=\"ScriptProcessor\";//\u4E00\u5806\u5B57\u7B26\u4E32\u540D\u5B57\uFF0C\u6709\u5229\u4E8E\u538B\u7F29js\n\tvar audioWorklet=\"audioWorklet\";\n\tvar recAudioWorklet=RecTxt+\" \"+audioWorklet;\n\tvar RecProc=\"RecProc\";\n\tvar MediaRecorderTxt=\"MediaRecorder\";\n\tvar MRWebMPCM=MediaRecorderTxt+\".WebM.PCM\";\n\n\n//===================\u8FDE\u63A5\u65B9\u5F0F\u4E09=========================\n\t//\u53E4\u8463\u7EA7\u522B\u7684 ScriptProcessor \u5904\u7406\uFF0C\u76EE\u524D\u6240\u6709\u6D4F\u89C8\u5668\u5747\u517C\u5BB9\uFF0C\u867D\u7136\u662F\u8FC7\u65F6\u7684\u65B9\u6CD5\uFF0C\u4F46\u66F4\u7A33\u5065\uFF0C\u79FB\u52A8\u7AEF\u6027\u80FD\u6BD4AudioWorklet\u5F3A\n\tvar oldFn=ctx.createScriptProcessor||ctx.createJavaScriptNode;\n\tvar oldIsBest=$T(\"ZGlf::\u3002\u7531\u4E8E{1}\u5185\u90E81\u79D2375\u6B21\u56DE\u8C03\uFF0C\u5728\u79FB\u52A8\u7AEF\u53EF\u80FD\u4F1A\u6709\u6027\u80FD\u95EE\u9898\u5BFC\u81F4\u56DE\u8C03\u4E22\u5931\u5F55\u97F3\u53D8\u77ED\uFF0CPC\u7AEF\u65E0\u5F71\u54CD\uFF0C\u6682\u4E0D\u5EFA\u8BAE\u5F00\u542F{1}\u3002\",0,audioWorklet);\n\tvar oldScript=function(){\n\t\tisWorklet=stream.isWorklet=false;\n\t\t_Disconn_n(stream);\n\t\tCLog($T(\"7TU0::Connect\u91C7\u7528\u8001\u7684{1}\uFF0C\",0,scriptProcessor)\n\t\t\t+i18n.get(Recorder[ConnectEnableWorklet]?\n\t\t\t\t$T(\"JwCL::\u4F46\u5DF2\u8BBE\u7F6E{1}\u5C1D\u8BD5\u542F\u7528{2}\",2)\n\t\t\t\t:$T(\"VGjB::\u53EF\u8BBE\u7F6E{1}\u5C1D\u8BD5\u542F\u7528{2}\",2)\n\t\t\t\t,[RecTxt+\".\"+ConnectEnableWorklet+\"=true\",audioWorklet]\n\t\t\t)+webMTips+oldIsBest,3);\n\t\t\n\t\tvar process=stream._p=oldFn.call(ctx,bufferSize,1,1);//\u5355\u58F0\u9053\uFF0C\u7701\u7684\u6570\u636E\u5904\u7406\u590D\u6742\n\t\tmediaConn(process);\n\t\t\n\t\tprocess.onaudioprocess=function(e){\n\t\t\tvar arr=e.inputBuffer.getChannelData(0);\n\t\t\tonReceive(arr);\n\t\t};\n\t};\n\n\n//===================\u8FDE\u63A5\u65B9\u5F0F\u4E8C=========================\nvar connWorklet=function(){\n\t//\u5C1D\u8BD5\u5F00\u542FAudioWorklet\u5904\u7406\n\tisWebM=stream.isWebM=false;\n\t_Disconn_r(stream);\n\t\n\tisWorklet=stream.isWorklet=!oldFn || Recorder[ConnectEnableWorklet];\n\tvar AwNode=window.AudioWorkletNode;\n\tif(!(isWorklet && ctx[audioWorklet] && AwNode)){\n\t\toldScript();//\u88AB\u7981\u7528 \u6216 \u4E0D\u652F\u6301\uFF0C\u76F4\u63A5\u4F7F\u7528\u8001\u7684\n\t\treturn;\n\t};\n\tvar clazzUrl=function(){\n\t\tvar xf=function(f){return f.toString().replace(/^function|DEL_/g,\"\").replace(/\\$RA/g,recAudioWorklet)};\n\t\tvar clazz='class '+RecProc+' extends AudioWorkletProcessor{';\n\t\t\tclazz+=\"constructor \"+xf(function(option){\n\t\t\t\tDEL_super(option);\n\t\t\t\tvar This=this,bufferSize=option.processorOptions.bufferSize;\n\t\t\t\tThis.bufferSize=bufferSize;\n\t\t\t\tThis.buffer=new Float32Array(bufferSize*2);//\u4E71\u7ED9size\u641E\u4E71\u7F13\u51B2\u533A\u4E0D\u7BA1\n\t\t\t\tThis.pos=0;\n\t\t\t\tThis.port.onmessage=function(e){\n\t\t\t\t\tif(e.data.kill){\n\t\t\t\t\t\tThis.kill=true;\n\t\t\t\t\t\t$C.log(\"$RA kill call\");\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\t$C.log(\"$RA .ctor call\", option);\n\t\t\t});\n\t\t\t\n\t\t\t//https://developer.mozilla.org/en-US/docs/Web/API/AudioWorkletProcessor/process \u6BCF\u6B21\u56DE\u8C03128\u4E2A\u91C7\u6837\u6570\u636E\uFF0C1\u79D2375\u6B21\u56DE\u8C03\uFF0C\u9AD8\u9891\u5BFC\u81F4\u79FB\u52A8\u7AEF\u6027\u80FD\u95EE\u9898\uFF0C\u7ED3\u679C\u5C31\u662F\u56DE\u8C03\u6B21\u6570\u7F3A\u65A4\u5C11\u4E24\uFF0C\u8FDB\u800C\u5BFC\u81F4\u4E22\u5931\u6570\u636E\uFF0CPC\u7AEF\u4F3C\u4E4E\u6CA1\u6709\u6027\u80FD\u95EE\u9898\n\t\t\tclazz+=\"process \"+xf(function(input,b,c){//\u9700\u8981\u7B49\u5230ctx\u6FC0\u6D3B\u540E\u624D\u4F1A\u6709\u56DE\u8C03\n\t\t\t\tvar This=this,bufferSize=This.bufferSize;\n\t\t\t\tvar buffer=This.buffer,pos=This.pos;\n\t\t\t\tinput=(input[0]||[])[0]||[];\n\t\t\t\tif(input.length){\n\t\t\t\t\tbuffer.set(input,pos);\n\t\t\t\t\tpos+=input.length;\n\t\t\t\t\t\n\t\t\t\t\tvar len=~~(pos/bufferSize)*bufferSize;\n\t\t\t\t\tif(len){\n\t\t\t\t\t\tthis.port.postMessage({ val: buffer.slice(0,len) });\n\t\t\t\t\t\t\n\t\t\t\t\t\tvar more=buffer.subarray(len,pos);\n\t\t\t\t\t\tbuffer=new Float32Array(bufferSize*2);\n\t\t\t\t\t\tbuffer.set(more);\n\t\t\t\t\t\tpos=more.length;\n\t\t\t\t\t\tThis.buffer=buffer;\n\t\t\t\t\t}\n\t\t\t\t\tThis.pos=pos;\n\t\t\t\t}\n\t\t\t\treturn !This.kill;\n\t\t\t});\n\t\tclazz+='}'\n\t\t\t+'try{'\n\t\t\t\t+'registerProcessor(\"'+RecProc+'\", '+RecProc+')'\n\t\t\t+'}catch(e){$C.error(\"'+recAudioWorklet+' Reg Error\",e)}';\n\t\tclazz=clazz.replace(/\\$C\\./g,\"console.\");//\u4E00\u4E9B\u7F16\u8BD1\u5668\u4F1A\u6587\u672C\u66FF\u6362\u65E5\u5FD7\u51FD\u6570\n\t\t//URL.createObjectURL \u672C\u5730\u6709\u4E9B\u6D4F\u89C8\u5668\u4F1A\u62A5 Not allowed to load local resource\uFF0C\u76F4\u63A5\u7528dataurl\n\t\treturn \"data:text/javascript;base64,\"+btoa(unescape(encodeURIComponent(clazz)));\n\t};\n\t\n\tvar awNext=function(){//\u53EF\u4EE5\u7EE7\u7EED\uFF0C\u6CA1\u6709\u8C03\u7528\u65AD\u5F00\n\t\treturn isWorklet && stream._na;\n\t};\n\tvar nodeAlive=stream._na=function(){\n\t\t//start\u65F6\u4F1A\u8C03\u7528\uFF0C\u53EA\u8981\u6CA1\u6709\u6536\u5230\u6570\u636E\u5C31\u65AD\u5B9AAudioWorklet\u6709\u95EE\u9898\uFF0C\u6062\u590D\u7528\u8001\u7684\n\t\tif(badInt!==\"\"){//\u6CA1\u6709\u56DE\u8C03\u8FC7\u6570\u636E\n\t\t\tclearTimeout(badInt);\n\t\t\tbadInt=setTimeout(function(){\n\t\t\t\tbadInt=0;\n\t\t\t\tif(awNext()){\n\t\t\t\t\tCLog($T(\"MxX1::{1}\u672A\u8FD4\u56DE\u4EFB\u4F55\u97F3\u9891\uFF0C\u6062\u590D\u4F7F\u7528{2}\",0,audioWorklet,scriptProcessor),3);\n\t\t\t\t\toldFn&&oldScript();//\u672A\u6765\u6CA1\u6709\u8001\u7684\uFF0C\u53EF\u80FD\u662F\u8BEF\u5224\n\t\t\t\t};\n\t\t\t},500);\n\t\t};\n\t};\n\tvar createNode=function(){\n\t\tif(!awNext())return;\n\t\tvar node=stream._n=new AwNode(ctx, RecProc, {\n\t\t\tprocessorOptions:{bufferSize:bufferSize}\n\t\t});\n\t\tmediaConn(node);\n\t\tnode.port.onmessage=function(e){\n\t\t\tif(badInt){\n\t\t\t\tclearTimeout(badInt);badInt=\"\";\n\t\t\t};\n\t\t\tif(awNext()){\n\t\t\t\tonReceive(e.data.val);\n\t\t\t}else if(!isWorklet){\n\t\t\t\tCLog($T(\"XUap::{1}\u591A\u4F59\u56DE\u8C03\",0,audioWorklet),3);\n\t\t\t};\n\t\t};\n\t\tCLog($T(\"yOta::Connect\u91C7\u7528{1}\uFF0C\u8BBE\u7F6E{2}\u53EF\u6062\u590D\u8001\u5F0F{3}\",0,audioWorklet,RecTxt+\".\"+ConnectEnableWorklet+\"=false\",scriptProcessor)+webMTips+oldIsBest,3);\n\t};\n\t\n\t//\u5982\u679Cstart\u65F6\u7684resume\u548C\u4E0B\u9762\u7684\u6784\u9020node\u540C\u65F6\u8FDB\u884C\uFF0C\u5C06\u4F1A\u5BFC\u81F4\u90E8\u5206\u6D4F\u89C8\u5668\u5D29\u6E83 (STATUS_ACCESS_VIOLATION)\uFF0C\u6E90\u7801assets\u4E2D ztest_chrome_bug_AudioWorkletNode.html \u53EF\u6D4B\u8BD5\u3002\u6240\u4EE5\uFF0C\u5C06\u6240\u6709\u4EE3\u7801\u5957\u5230resume\u91CC\u9762\uFF08\u4E0D\u7BA1catch\uFF09\uFF0C\u907F\u514D\u51FA\u73B0\u8FD9\u4E2A\u95EE\u9898\n\tvar ctxOK=function(){\n\t\tif(!awNext())return;\n\t\tif(ctx[RecProc]){\n\t\t\tcreateNode();\n\t\t\treturn;\n\t\t};\n\t\tvar url=clazzUrl();\n\t\tctx[audioWorklet].addModule(url).then(function(e){\n\t\t\tif(!awNext())return;\n\t\t\tctx[RecProc]=1;\n\t\t\tcreateNode();\n\t\t\tif(badInt){//\u91CD\u65B0\u8BA1\u65F6\n\t\t\t\tnodeAlive();\n\t\t\t};\n\t\t})[CatchTxt](function(e){ //fix \u5173\u952E\u5B57\uFF0C\u4FDD\u8BC1catch\u538B\u7F29\u65F6\u4FDD\u6301\u5B57\u7B26\u4E32\u5F62\u5F0F\n\t\t\tCLog(audioWorklet+\".addModule Error\",1,e);\n\t\t\tawNext()&&oldScript();\n\t\t});\n\t};\n\tResumeCtx(ctx,function(){ return awNext() } ,ctxOK,ctxOK);\n};\n\n\n//===================\u8FDE\u63A5\u65B9\u5F0F\u4E00=========================\nvar connWebM=function(){\n\t//\u5C1D\u8BD5\u5F00\u542FMediaRecorder\u5F55\u5236webm+pcm\u5904\u7406\n\tvar MR=window[MediaRecorderTxt];\n\tvar onData=\"ondataavailable\";\n\tvar webmType=\"audio/webm; codecs=pcm\";\n\tisWebM=stream.isWebM=Recorder[ConnectEnableWebM];\n\t\n\tvar supportMR=MR && (onData in MR.prototype) && MR.isTypeSupported(webmType);\n\twebMTips=supportMR?\"\":$T(\"VwPd::\uFF08\u6B64\u6D4F\u89C8\u5668\u4E0D\u652F\u6301{1}\uFF09\",0,MRWebMPCM);\n\tif(!isUserMedia || !isWebM || !supportMR){\n\t\tconnWorklet(); //\u975E\u9EA6\u514B\u98CE\u5F55\u97F3\uFF08MediaRecorder\u91C7\u6837\u7387\u4E0D\u53EF\u63A7\uFF09 \u6216 \u88AB\u7981\u7528 \u6216 \u4E0D\u652F\u6301MediaRecorder \u6216 \u4E0D\u652F\u6301webm+pcm\n\t\treturn;\n\t}\n\t\n\tvar mrNext=function(){//\u53EF\u4EE5\u7EE7\u7EED\uFF0C\u6CA1\u6709\u8C03\u7528\u65AD\u5F00\n\t\treturn isWebM && stream._ra;\n\t};\n\tvar mrAlive=stream._ra=function(){\n\t\t//start\u65F6\u4F1A\u8C03\u7528\uFF0C\u53EA\u8981\u6CA1\u6709\u6536\u5230\u6570\u636E\u5C31\u65AD\u5B9AMediaRecorder\u6709\u95EE\u9898\uFF0C\u964D\u7EA7\u5904\u7406\n\t\tif(badInt!==\"\"){//\u6CA1\u6709\u56DE\u8C03\u8FC7\u6570\u636E\n\t\t\tclearTimeout(badInt);\n\t\t\tbadInt=setTimeout(function(){\n\t\t\t\t//badInt=0; \u4FDD\u7559\u7ED9nodeAlive\u7EE7\u7EED\u5224\u65AD\n\t\t\t\tif(mrNext()){\n\t\t\t\t\tCLog($T(\"vHnb::{1}\u672A\u8FD4\u56DE\u4EFB\u4F55\u97F3\u9891\uFF0C\u964D\u7EA7\u4F7F\u7528{2}\",0,MediaRecorderTxt,audioWorklet),3);\n\t\t\t\t\tconnWorklet();\n\t\t\t\t};\n\t\t\t},500);\n\t\t};\n\t};\n\t\n\tvar mrSet=Object.assign({mimeType:webmType}, Recorder.ConnectWebMOptions);\n\tvar mr=stream._r=new MR(stream, mrSet);\n\tvar webmData=stream._rd={sampleRate:ctx[sampleRateTxt]};\n\tmr[onData]=function(e){\n\t\t//\u63D0\u53D6webm\u4E2D\u7684pcm\u6570\u636E\uFF0C\u63D0\u53D6\u5931\u8D25\u5C31\u7B49\u7740badInt\u8D85\u65F6\u964D\u7EA7\u5904\u7406\n\t\tvar reader=new FileReader();\n\t\treader.onloadend=function(){\n\t\t\tif(mrNext()){\n\t\t\t\tvar f32arr=WebM_Extract(new Uint8Array(reader.result),webmData);\n\t\t\t\tif(!f32arr)return;\n\t\t\t\tif(f32arr==-1){//\u65E0\u6CD5\u63D0\u53D6\uFF0C\u7ACB\u5373\u964D\u7EA7\n\t\t\t\t\tconnWorklet();\n\t\t\t\t\treturn;\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\tif(badInt){\n\t\t\t\t\tclearTimeout(badInt);badInt=\"\";\n\t\t\t\t};\n\t\t\t\tonReceive(f32arr);\n\t\t\t}else if(!isWebM){\n\t\t\t\tCLog($T(\"O9P7::{1}\u591A\u4F59\u56DE\u8C03\",0,MediaRecorderTxt),3);\n\t\t\t};\n\t\t};\n\t\treader.readAsArrayBuffer(e.data);\n\t};\n\tmr.start(~~(bufferSize/48));//\u630948k\u65F6\u7684\u56DE\u8C03\u95F4\u9694\n\tCLog($T(\"LMEm::Connect\u91C7\u7528{1}\uFF0C\u8BBE\u7F6E{2}\u53EF\u6062\u590D\u4F7F\u7528{3}\u6216\u8001\u5F0F{4}\",0,MRWebMPCM,RecTxt+\".\"+ConnectEnableWebM+\"=false\",audioWorklet,scriptProcessor));\n};\n\n\tconnWebM();\n};\nvar ConnAlive=function(stream){\n\tif(stream._na) stream._na(); //\u68C0\u67E5AudioWorklet\u8FDE\u63A5\u662F\u5426\u6709\u6548\uFF0C\u65E0\u6548\u5C31\u56DE\u6EDA\u5230\u8001\u7684ScriptProcessor\n\tif(stream._ra) stream._ra(); //\u68C0\u67E5MediaRecorder\u8FDE\u63A5\u662F\u5426\u6709\u6548\uFF0C\u65E0\u6548\u5C31\u964D\u7EA7\u5904\u7406\n};\nvar _Disconn_n=function(stream){\n\tstream._na=null;\n\tif(stream._n){\n\t\tstream._n.port.postMessage({kill:true});\n\t\tstream._n.disconnect();\n\t\tstream._n=null;\n\t};\n};\nvar _Disconn_r=function(stream){\n\tstream._ra=null;\n\tif(stream._r){\n\t\ttry{ stream._r.stop() }catch(e){ CLog(\"mr stop err\",1,e) }\n\t\tstream._r=null;\n\t};\n};\nvar Disconnect=function(streamStore){\n\tstreamStore=streamStore||Recorder;\n\tvar isGlobal=streamStore==Recorder;\n\t\n\tvar stream=streamStore.Stream;\n\tif(stream){\n\t\tif(stream._m){\n\t\t\tstream._m.disconnect();\n\t\t\tstream._m=null;\n\t\t};\n\t\tif(!stream._RC && stream._c){//\u63D0\u4F9B\u7684runningContext\u4E0D\u5904\u7406\n\t\t\tRecorder.CloseNewCtx(stream._c);\n\t\t};\n\t\tstream._RC=null; stream._c=null;\n\t\tif(stream._d){\n\t\t\tStopS_(stream._d.stream);\n\t\t\tstream._d=null;\n\t\t};\n\t\tif(stream._p){\n\t\t\tstream._p.disconnect();\n\t\t\tstream._p.onaudioprocess=stream._p=null;\n\t\t};\n\t\t_Disconn_n(stream);\n\t\t_Disconn_r(stream);\n\t\t\n\t\tif(isGlobal){//\u5168\u5C40\u7684\u65F6\u5019\uFF0C\u8981\u628A\u6D41\u5173\u6389\uFF08\u9EA6\u514B\u98CE\uFF09\uFF0C\u76F4\u63A5\u63D0\u4F9B\u7684\u6D41\u4E0D\u5904\u7406\n\t\t\tStopS_(stream);\n\t\t};\n\t};\n\tstreamStore.Stream=0;\n};\n//\u5173\u95ED\u4E00\u4E2A\u97F3\u9891\u6D41\nvar StopS_=Recorder.StopS_=function(stream){\n\tvar tracks=stream.getTracks&&stream.getTracks()||stream.audioTracks||[];\n\tfor(var i=0;i<tracks.length;i++){\n\t\tvar track=tracks[i];\n\t\ttrack.stop&&track.stop();\n\t};\n\tstream.stop&&stream.stop();\n};\n\n/*\u5BF9pcm\u6570\u636E\u7684\u91C7\u6837\u7387\u8FDB\u884C\u8F6C\u6362\npcmDatas: [[Int16,...]] pcm\u7247\u6BB5\u5217\u8868\npcmSampleRate:48000 pcm\u6570\u636E\u7684\u91C7\u6837\u7387\nnewSampleRate:16000 \u9700\u8981\u8F6C\u6362\u6210\u7684\u91C7\u6837\u7387\uFF0CnewSampleRate>=pcmSampleRate\u65F6\u4E0D\u4F1A\u8FDB\u884C\u4EFB\u4F55\u5904\u7406\uFF0C\u5C0F\u4E8E\u65F6\u4F1A\u8FDB\u884C\u91CD\u65B0\u91C7\u6837\nprevChunkInfo:{} \u53EF\u9009\uFF0C\u4E0A\u6B21\u8C03\u7528\u65F6\u7684\u8FD4\u56DE\u503C\uFF0C\u7528\u4E8E\u8FDE\u7EED\u8F6C\u6362\uFF0C\u672C\u6B21\u8C03\u7528\u5C06\u4ECE\u4E0A\u6B21\u7ED3\u675F\u4F4D\u7F6E\u5F00\u59CB\u8FDB\u884C\u5904\u7406\u3002\u6216\u53EF\u81EA\u884C\u5B9A\u4E49\u4E00\u4E2AChunkInfo\u4ECEpcmDatas\u6307\u5B9A\u7684\u4F4D\u7F6E\u5F00\u59CB\u8FDB\u884C\u8F6C\u6362\noption:{ \u53EF\u9009\uFF0C\u914D\u7F6E\u9879\n\t\tframeSize:123456 \u5E27\u5927\u5C0F\uFF0C\u6BCF\u5E27\u7684PCM Int16\u7684\u6570\u91CF\uFF0C\u91C7\u6837\u7387\u8F6C\u6362\u540E\u7684pcm\u957F\u5EA6\u4E3AframeSize\u7684\u6574\u6570\u500D\uFF0C\u7528\u4E8E\u8FDE\u7EED\u8F6C\u6362\u3002\u76EE\u524D\u4EC5\u5728mp3\u683C\u5F0F\u65F6\u624D\u6709\u7528\uFF0CframeSize\u53D6\u503C\u4E3A1152\uFF0C\u8FD9\u6837\u7F16\u7801\u51FA\u6765\u7684mp3\u65F6\u957F\u548Cpcm\u7684\u65F6\u957F\u5B8C\u5168\u4E00\u81F4\uFF0C\u5426\u5219\u4F1A\u56E0\u4E3Amp3\u6700\u540E\u4E00\u5E27\u5F55\u97F3\u4E0D\u591F\u586B\u6EE1\u65F6\u6DFB\u52A0\u586B\u5145\u6570\u636E\u5BFC\u81F4mp3\u7684\u65F6\u957F\u53D8\u957F\u3002\n\t\tframeType:\"\" \u5E27\u7C7B\u578B\uFF0C\u4E00\u822C\u4E3Arec.set.type\uFF0C\u63D0\u4F9B\u6B64\u53C2\u6570\u65F6\u65E0\u9700\u63D0\u4F9BframeSize\uFF0C\u4F1A\u81EA\u52A8\u4F7F\u7528\u6700\u4F73\u7684\u503C\u7ED9frameSize\u8D4B\u503C\uFF0C\u76EE\u524D\u4EC5\u652F\u6301mp3=1152(MPEG1 Layer3\u7684\u6BCF\u5E27\u91C7\u91C7\u6837\u6570)\uFF0C\u5176\u4ED6\u7C7B\u578B=1\u3002\n\t\t\t\u4EE5\u4E0A\u4E24\u4E2A\u53C2\u6570\u7528\u4E8E\u8FDE\u7EED\u8F6C\u6362\u65F6\u4F7F\u7528\uFF0C\u6700\u591A\u4F7F\u7528\u4E00\u4E2A\uFF0C\u4E0D\u63D0\u4F9B\u65F6\u4E0D\u8FDB\u884C\u5E27\u7684\u7279\u6B8A\u5904\u7406\uFF0C\u63D0\u4F9B\u65F6\u5FC5\u987B\u540C\u65F6\u63D0\u4F9BprevChunkInfo\u624D\u6709\u4F5C\u7528\u3002\u6700\u540E\u4E00\u6BB5\u6570\u636E\u5904\u7406\u65F6\u65E0\u9700\u63D0\u4F9B\u5E27\u5927\u5C0F\u4EE5\u4FBF\u8F93\u51FA\u6700\u540E\u4E00\u4E01\u70B9\u6B8B\u7559\u6570\u636E\u3002\n\t}\n\n\u8FD4\u56DEChunkInfo:{\n\t//\u53EF\u5B9A\u4E49\uFF0C\u4ECE\u6307\u5B9A\u4F4D\u7F6E\u5F00\u59CB\u8F6C\u6362\u5230\u7ED3\u5C3E\n\tindex:0 pcmDatas\u5DF2\u5904\u7406\u5230\u7684\u7D22\u5F15\n\toffset:0.0 \u5DF2\u5904\u7406\u5230\u7684index\u5BF9\u5E94\u7684pcm\u4E2D\u7684\u504F\u79FB\u7684\u4E0B\u4E00\u4E2A\u4F4D\u7F6E\n\t\n\t//\u53EF\u5B9A\u4E49\uFF0C\u6307\u5B9A\u7684\u4E00\u4E2A\u6EE4\u6CE2\u914D\u7F6E\uFF1A\u9ED8\u8BA4\u4F7F\u7528Recorder.IIRFilter\u4F4E\u901A\u6EE4\u6CE2\uFF08\u53EF\u6709\u6548\u6291\u5236\u6DF7\u53E0\u4EA7\u751F\u7684\u6742\u97F3\uFF0C\u65B0\u91C7\u6837\u7387\u5927\u4E8Epcm\u91C7\u6837\u7387\u768475%\u65F6\u4E0D\u9ED8\u8BA4\u6EE4\u6CE2\uFF09\uFF0C\u5982\u679C\u63D0\u4F9B\u4E86\u914D\u7F6E\u4F46fn\u4E3Anull\u65F6\u5C06\u4E0D\u6EE4\u6CE2\uFF1Bsr\u4E3A\u6B64\u6EE4\u6CE2\u51FD\u6570\u5BF9\u5E94\u7684\u521D\u59CB\u5316\u91C7\u6837\u7387\uFF0C\u5F53\u91C7\u6837\u7387\u548CpcmSampleRate\u53C2\u6570\u4E0D\u4E00\u81F4\u65F6\u5C06\u91CD\u65B0\u8BBE\u4E3A\u9ED8\u8BA4\u51FD\u6570\n\tfilter:null||{fn:fn(sample),sr:pcmSampleRate}\n\t\n\t//\u4EC5\u4F5C\u4E3A\u8FD4\u56DE\u503C\n\tframeNext:null||[Int16,...] \u4E0B\u4E00\u5E27\u7684\u90E8\u5206\u6570\u636E\uFF0CframeSize\u8BBE\u7F6E\u4E86\u7684\u65F6\u5019\u624D\u53EF\u80FD\u4F1A\u6709\n\tsampleRate:16000 \u7ED3\u679C\u7684\u91C7\u6837\u7387\uFF0C<=newSampleRate\n\tdata:[Int16,...] \u8F6C\u6362\u540E\u7684PCM\u7ED3\u679C\uFF1B\u5982\u679C\u662F\u8FDE\u7EED\u8F6C\u6362\uFF0C\u5E76\u4E14pcmDatas\u4E2D\u5E76\u6CA1\u6709\u65B0\u6570\u636E\u65F6\uFF0Cdata\u7684\u957F\u5EA6\u53EF\u80FD\u4E3A0\n}\n*/\nRecorder.SampleData=function(pcmDatas,pcmSampleRate,newSampleRate,prevChunkInfo,option){\n\tvar Txt=\"SampleData\";\n\tprevChunkInfo||(prevChunkInfo={});\n\tvar index=prevChunkInfo.index||0;\n\tvar offset=prevChunkInfo.offset||0;\n\t\n\tvar filter=prevChunkInfo.filter;\n\tif(filter&&filter.fn&&filter.sr!=pcmSampleRate){\n\t\tfilter=null; CLog($T(\"d48C::{1}\u7684filter\u91C7\u6837\u7387\u53D8\u4E86\uFF0C\u91CD\u8BBE\u6EE4\u6CE2\",0,Txt),3);\n\t};\n\tif(!filter){//\u91C7\u6837\u7387\u5DEE\u8DDD\u6BD4\u8F83\u5927\u624D\u5F00\u542F\u4F4E\u901A\u6EE4\u6CE2\uFF0C\u6700\u9AD8\u9891\u7387\u7528\u65B0\u91C7\u6837\u7387\u9891\u7387\u76843/4\n\t\tvar freq=newSampleRate>pcmSampleRate*3/4?0: newSampleRate/2 *3/4;\n\t\tfilter={fn:freq?Recorder.IIRFilter(true,pcmSampleRate,freq):0};\n\t};\n\tfilter.sr=pcmSampleRate;\n\tvar filterFn=filter.fn;\n\t\n\tvar frameNext=prevChunkInfo.frameNext||[];\n\toption||(option={});\n\tvar frameSize=option.frameSize||1;\n\tif(option.frameType){\n\t\tframeSize=option.frameType==\"mp3\"?1152:1;\n\t};\n\t\n\tvar nLen=pcmDatas.length;\n\tif(index>nLen+1){\n\t\tCLog($T(\"tlbC::{1}\u4F3C\u4E4E\u4F20\u5165\u4E86\u672A\u91CD\u7F6Echunk {2}\",0,Txt,index+\">\"+nLen),3);\n\t};\n\tvar size=0;\n\tfor(var i=index;i<nLen;i++){\n\t\tsize+=pcmDatas[i].length;\n\t};\n\tsize=Math.max(0,size-Math.floor(offset));\n\t\n\t//\u91C7\u6837 https://www.cnblogs.com/blqw/p/3782420.html\n\tvar step=pcmSampleRate/newSampleRate;\n\tif(step>1){//\u65B0\u91C7\u6837\u4F4E\u4E8E\u5F55\u97F3\u91C7\u6837\uFF0C\u8FDB\u884C\u62BD\u6837\n\t\tsize=Math.floor(size/step);\n\t}else{//\u65B0\u91C7\u6837\u9AD8\u4E8E\u5F55\u97F3\u91C7\u6837\u4E0D\u5904\u7406\uFF0C\u7701\u53BB\u4E86\u63D2\u503C\u5904\u7406\n\t\tstep=1;\n\t\tnewSampleRate=pcmSampleRate;\n\t};\n\t\n\tsize+=frameNext.length;\n\tvar res=new Int16Array(size);\n\tvar idx=0;\n\t//\u6DFB\u52A0\u4E0A\u4E00\u6B21\u4E0D\u591F\u4E00\u5E27\u7684\u5269\u4F59\u6570\u636E\n\tfor(var i=0;i<frameNext.length;i++){\n\t\tres[idx]=frameNext[i];\n\t\tidx++;\n\t};\n\t//\u5904\u7406\u6570\u636E\n\tfor (;index<nLen;index++) {\n\t\tvar o=pcmDatas[index];\n\t\tvar i=offset,il=o.length;\n\t\tvar F=filterFn&&filterFn.Embed,F1=0,F2=0,Fx=0,Fy=0;//\u4F4E\u901A\u6EE4\u6CE2\u540E\u7684\u6570\u636E\n\t\tfor(var i0=0,i2=0;i0<il;i0++,i2++){\n\t\t\tif(i2<il){\n\t\t\t\tif(F){//IIRFilter\u4EE3\u7801\u5185\u7F6E\uFF0C\u6BD4\u51FD\u6570\u8C03\u7528\u5FEB4\u500D\n\t\t\t\t\tFx=o[i2];\n\t\t\t\t\tFy=F.b0 * Fx + F.b1 * F.x1 + F.b0 * F.x2 - F.a1 * F.y1 - F.a2 * F.y2;\n\t\t\t\t\tF.x2 = F.x1; F.x1 = Fx; F.y2 = F.y1; F.y1 = Fy;\n\t\t\t\t}else{ Fy=filterFn?filterFn(o[i2]):o[i2]; }\n\t\t\t}\n\t\t\tF1=F2; F2=Fy;\n\t\t\tif(i2==0){ i0--; continue; } //\u9996\u6B21\u53EA\u8BA1\u7B97o[0]\n\t\t\t//res[idx]=o[Math.round(i)]; \u76F4\u63A5\u7B80\u5355\u62BD\u6837\n\t\t\t\n\t\t\t//https://www.cnblogs.com/xiaoqi/p/6993912.html\n\t\t\t//\u5F53\u524D\u70B9=\u5F53\u524D\u70B9+\u5230\u540E\u9762\u4E00\u4E2A\u70B9\u4E4B\u95F4\u7684\u589E\u91CF\uFF0C\u97F3\u8D28\u6BD4\u76F4\u63A5\u7B80\u5355\u62BD\u6837\u597D\u4E9B\n\t\t\tvar before = Math.floor(i);\n\t\t\tif(i0!=before)continue;\n\t\t\tvar after = Math.ceil(i);\n\t\t\tvar atPoint = i - before;\n\t\t\t\n\t\t\tvar beforeVal=F1;\n\t\t\tvar afterVal=after<il ? F2 : beforeVal; //\u540E\u4E2A\u70B9\u8D8A\u754C\u4E86\uFF0C\u5FFD\u7565\u4E0D\u8BA1\n\t\t\tvar val=beforeVal+(afterVal-beforeVal)*atPoint;\n\t\t\t\n\t\t\tif(val>0x7FFF) val=0x7FFF; else if(val<-0x8000) val=-0x8000; //Int16\u8D8A\u754C\u5904\u7406\n\t\t\tres[idx]=val;\n\t\t\t\n\t\t\tidx++;\n\t\t\ti+=step;//\u62BD\u6837\n\t\t};\n\t\toffset=Math.max(0, i-il); //\u4E0D\u592A\u53EF\u80FD\u51FA\u73B0\u8D1F\u6570\n\t};\n\t//\u5E27\u5904\u7406\n\tframeNext=null;\n\tvar frameNextSize=res.length%frameSize;\n\tif(frameNextSize>0){\n\t\tvar u8Pos=(res.length-frameNextSize)*2;\n\t\tframeNext=new Int16Array(res.buffer.slice(u8Pos));\n\t\tres=new Int16Array(res.buffer.slice(0,u8Pos));\n\t};\n\t\n\treturn {\n\t\tindex:index\n\t\t,offset:offset\n\t\t,filter:filter\n\t\t\n\t\t,frameNext:frameNext\n\t\t,sampleRate:newSampleRate\n\t\t,data:res\n\t};\n};\n\n/*IIR\u4F4E\u901A\u3001\u9AD8\u901A\u6EE4\u6CE2\uFF0C\u79FB\u690D\u81EA\uFF1Ahttps://gitee.com/52jian/digital-audio-filter AudioFilter.java\n\tuseLowPass: true\u6216false\uFF0Ctrue\u4E3A\u4F4E\u901A\u6EE4\u6CE2\uFF0Cfalse\u4E3A\u9AD8\u901A\u6EE4\u6CE2\n\tsampleRate: \u5F85\u5904\u7406pcm\u7684\u91C7\u6837\u7387\n\tfreq: \u622A\u6B62\u9891\u7387Hz\uFF0C\u6700\u5927\u9891\u7387\u4E3AsampleRate/2\uFF0C\u4F4E\u901A\u65F6\u4F1A\u5207\u6389\u9AD8\u4E8E\u6B64\u9891\u7387\u7684\u58F0\u97F3\uFF0C\u9AD8\u901A\u65F6\u4F1A\u5207\u6389\u4F4E\u4E8E\u6B64\u9891\u7387\u7684\u58F0\u97F3\uFF0C\u6CE8\u610F\u6EE4\u6CE2\u5E76\u975E100%\u7684\u5207\u6389\u4E0D\u9700\u8981\u7684\u58F0\u97F3\uFF0C\u800C\u662F\u51CF\u5F31\u9891\u7387\u5BF9\u5E94\u7684\u58F0\u97F3\uFF0C\u79BB\u622A\u6B62\u9891\u7387\u8D8A\u8FDC\u5BF9\u5E94\u58F0\u97F3\u51CF\u5F31\u8D8A\u5389\u5BB3\uFF0C\u79BB\u622A\u6B62\u9891\u7387\u8D8A\u8FD1\u58F0\u97F3\u5C31\u51E0\u4E4E\u65E0\u8870\u51CF\n\t\u8FD4\u56DE\u7684\u662F\u4E00\u4E2A\u51FD\u6570\uFF0C\u7528\u6B64\u51FD\u6570\u5BF9pcm\u7684\u6BCF\u4E2A\u91C7\u6837\u503C\u6309\u987A\u5E8F\u8FDB\u884C\u5904\u7406\u5373\u53EF\uFF08\u4E0D\u540Cpcm\u4E0D\u53EF\u5171\u7528\uFF09\uFF1B\u6CE8\u610F\u6B64\u51FD\u6570\u8FD4\u56DE\u503C\u53EF\u80FD\u4F1A\u8D8A\u754C\u8D85\u8FC7Int16\u8303\u56F4\uFF0C\u81EA\u884C\u9650\u5236\u4E00\u4E0B\u5373\u53EF\uFF1AMath.min(Math.max(val,-0x8000),0x7FFF)\n\u53EF\u91CD\u65B0\u8D4B\u503C\u4E00\u4E2A\u51FD\u6570\uFF0C\u6765\u6539\u53D8Recorder\u7684\u9ED8\u8BA4\u884C\u4E3A\uFF0C\u6BD4\u5982SampleData\u4E2D\u7684\u4F4E\u901A\u6EE4\u6CE2*/\nRecorder.IIRFilter=function(useLowPass, sampleRate, freq){\n\tvar ov = 2 * Math.PI * freq / sampleRate;\n\tvar sn = Math.sin(ov);\n\tvar cs = Math.cos(ov);\n\tvar alpha = sn / 2;\n\t\n\tvar a0 = 1 + alpha;\n\tvar a1 = (-2 * cs) / a0;\n\tvar a2 = (1 - alpha) / a0;\n\tif(useLowPass){\n\t\tvar b0 = (1 - cs) / 2 / a0;\n\t\tvar b1 = (1 - cs) / a0;\n\t}else{\n\t\tvar b0 = (1 + cs) / 2 / a0;\n\t\tvar b1 = -(1 + cs) / a0;\n\t}\n\t\n\tvar x1=0,x2=0,y=0,y1=0,y2=0;\n\tvar fn=function(x){\n\t\ty = b0 * x + b1 * x1 + b0 * x2 - a1 * y1 - a2 * y2;\n\t\tx2 = x1; x1 = x;\n\t\ty2 = y1; y1 = y;\n\t\treturn y;\n\t};\n\tfn.Embed={x1:0,x2:0,y1:0,y2:0,b0:b0,b1:b1,a1:a1,a2:a2};\n\treturn fn;\n};\n\n\n/*\u8BA1\u7B97\u97F3\u91CF\u767E\u5206\u6BD4\u7684\u4E00\u4E2A\u65B9\u6CD5\npcmAbsSum: pcm Int16\u6240\u6709\u91C7\u6837\u7684\u7EDD\u5BF9\u503C\u7684\u548C\npcmLength: pcm\u957F\u5EA6\n\u8FD4\u56DE\u503C\uFF1A0-100\uFF0C\u4E3B\u8981\u5F53\u505A\u767E\u5206\u6BD4\u7528\n\u6CE8\u610F\uFF1A\u8FD9\u4E2A\u4E0D\u662F\u5206\u8D1D\uFF0C\u56E0\u6B64\u6CA1\u7528volume\u5F53\u505A\u540D\u79F0*/\nRecorder.PowerLevel=function(pcmAbsSum,pcmLength){\n\t/*\u8BA1\u7B97\u97F3\u91CF https://blog.csdn.net/jody1989/article/details/73480259\n\t\u66F4\u9AD8\u7075\u654F\u5EA6\u7B97\u6CD5:\n\t\t\u9650\u5B9A\u6700\u5927\u611F\u5E94\u503C10000\n\t\t\t\u7EBF\u6027\u66F2\u7EBF\uFF1A\u4F4E\u97F3\u91CF\u4E0D\u53CB\u597D\n\t\t\t\tpower/10000*100 \n\t\t\t\u5BF9\u6570\u66F2\u7EBF\uFF1A\u4F4E\u97F3\u91CF\u53CB\u597D\uFF0C\u4F46\u9700\u9650\u5B9A\u6700\u4F4E\u611F\u5E94\u503C\n\t\t\t\t(1+Math.log10(power/10000))*100\n\t*/\n\tvar power=(pcmAbsSum/pcmLength) || 0;//NaN\n\tvar level;\n\tif(power<1251){//1250\u7684\u7ED3\u679C10%\uFF0C\u66F4\u5C0F\u7684\u97F3\u91CF\u91C7\u7528\u7EBF\u6027\u53D6\u503C\n\t\tlevel=Math.round(power/1250*10);\n\t}else{\n\t\tlevel=Math.round(Math.min(100,Math.max(0,(1+Math.log(power/10000)/Math.log(10))*100)));\n\t};\n\treturn level;\n};\n\n/*\u8BA1\u7B97\u97F3\u91CF\uFF0C\u5355\u4F4DdBFS\uFF08\u6EE1\u523B\u5EA6\u76F8\u5BF9\u7535\u5E73\uFF09\nmaxSample: \u4E3A16\u4F4Dpcm\u91C7\u6837\u7684\u7EDD\u5BF9\u503C\u4E2D\u6700\u5927\u7684\u4E00\u4E2A\uFF08\u8BA1\u7B97\u5CF0\u503C\u97F3\u91CF\uFF09\uFF0C\u6216\u8005\u4E3Apcm\u4E2D\u6240\u6709\u91C7\u6837\u7684\u7EDD\u5BF9\u503C\u7684\u5E73\u5C40\u503C\n\u8FD4\u56DE\u503C\uFF1A-100~0 \uFF08\u6700\u5927\u503C0dB\uFF0C\u6700\u5C0F\u503C-100\u4EE3\u66FF-\u221E\uFF09\n*/\nRecorder.PowerDBFS=function(maxSample){\n\tvar val=Math.max(0.1, maxSample||0),Pref=0x7FFF;\n\tval=Math.min(val,Pref);\n\t//https://www.logiclocmusic.com/can-you-tell-the-decibel/\n\t//https://blog.csdn.net/qq_17256689/article/details/120442510\n\tval=20*Math.log(val/Pref)/Math.log(10);\n\treturn Math.max(-100,Math.round(val));\n};\n\n\n\n\n//\u5E26\u65F6\u95F4\u7684\u65E5\u5FD7\u8F93\u51FA\uFF0C\u53EF\u8BBE\u4E3A\u4E00\u4E2A\u7A7A\u51FD\u6570\u6765\u5C4F\u853D\u65E5\u5FD7\u8F93\u51FA\n//CLog(msg,errOrLogMsg, logMsg...) err\u4E3A\u6570\u5B57\u65F6\u4EE3\u8868\u65E5\u5FD7\u7C7B\u578B1:error 2:log\u9ED8\u8BA4 3:warn\uFF0C\u5426\u5219\u5F53\u505A\u5185\u5BB9\u8F93\u51FA\uFF0C\u7B2C\u4E00\u4E2A\u53C2\u6570\u4E0D\u80FD\u662F\u5BF9\u8C61\u56E0\u4E3A\u8981\u62FC\u63A5\u65F6\u95F4\uFF0C\u540E\u9762\u53EF\u4EE5\u63A5\u65E0\u6570\u4E2A\u8F93\u51FA\u53C2\u6570\nRecorder.CLog=function(msg,err){\n\tif(typeof console!=\"object\")return;\n\tvar now=new Date();\n\tvar t=(\"0\"+now.getMinutes()).substr(-2)\n\t\t+\":\"+(\"0\"+now.getSeconds()).substr(-2)\n\t\t+\".\"+(\"00\"+now.getMilliseconds()).substr(-3);\n\tvar recID=this&&this.envIn&&this.envCheck&&this.id;\n\tvar arr=[\"[\"+t+\" \"+RecTxt+(recID?\":\"+recID:\"\")+\"]\"+msg];\n\tvar a=arguments,cwe=Recorder.CLog;\n\tvar i=2,fn=cwe.log||console.log;\n\tif(IsNum(err)){\n\t\tfn=err==1?cwe.error||console.error:err==3?cwe.warn||console.warn:fn;\n\t}else{\n\t\ti=1;\n\t};\n\tfor(;i<a.length;i++){\n\t\tarr.push(a[i]);\n\t};\n\tif(IsLoser){//\u53E4\u8463\u6D4F\u89C8\u5668\uFF0C\u4EC5\u4FDD\u8BC1\u57FA\u672C\u7684\u53EF\u6267\u884C\u4E0D\u4EE3\u7801\u5F02\u5E38\n\t\tfn&&fn(\"[IsLoser]\"+arr[0],arr.length>1?arr:\"\");\n\t}else{\n\t\tfn.apply(console,arr);\n\t};\n};\nvar CLog=function(){ Recorder.CLog.apply(this,arguments); };\nvar IsLoser=true;try{IsLoser=!console.log.apply;}catch(e){};\n\n\n\n\nvar ID=0;\nfunction initFn(set){\n\tvar This=this; This.id=++ID;\n\t\n\t//\u5982\u679C\u5F00\u542F\u4E86\u6D41\u91CF\u7EDF\u8BA1\uFF0C\u8FD9\u91CC\u5C06\u53D1\u9001\u4E00\u4E2A\u56FE\u7247\u8BF7\u6C42\n\tTraffic();\n\t\n\t\n\tvar o={\n\t\ttype:\"mp3\" //\u8F93\u51FA\u7C7B\u578B\uFF1Amp3,wav\uFF0Cwav\u8F93\u51FA\u6587\u4EF6\u5C3A\u5BF8\u8D85\u5927\u4E0D\u63A8\u8350\u4F7F\u7528\uFF0C\u4F46mp3\u7F16\u7801\u652F\u6301\u4F1A\u5BFC\u81F4js\u6587\u4EF6\u8D85\u5927\uFF0C\u5982\u679C\u4E0D\u9700\u652F\u6301mp3\u53EF\u4EE5\u4F7Fjs\u6587\u4EF6\u5927\u5E45\u51CF\u5C0F\n\t\t//,bitRate:16 //\u6BD4\u7279\u7387 wav:16\u62168\u4F4D\uFF0CMP3\uFF1A8kbps 1k/s\uFF0C8kbps 2k/s \u5F55\u97F3\u6587\u4EF6\u5F88\u5C0F\n\t\t\n\t\t//,sampleRate:16000 //\u91C7\u6837\u7387\uFF0Cwav\u683C\u5F0F\u5927\u5C0F=sampleRate*\u65F6\u95F4\uFF1Bmp3\u6B64\u9879\u5BF9\u4F4E\u6BD4\u7279\u7387\u6709\u5F71\u54CD\uFF0C\u9AD8\u6BD4\u7279\u7387\u51E0\u4E4E\u65E0\u5F71\u54CD\u3002\n\t\t\t\t\t//wav\u4EFB\u610F\u503C\uFF0Cmp3\u53D6\u503C\u8303\u56F4\uFF1A48000, 44100, 32000, 24000, 22050, 16000, 12000, 11025, 8000\n\t\t\t\t\t//\u91C7\u6837\u7387\u53C2\u8003https://www.cnblogs.com/devin87/p/mp3-recorder.html\n\t\t\n\t\t,onProcess:NOOP //fn(buffers,powerLevel,bufferDuration,bufferSampleRate,newBufferIdx,asyncEnd) buffers=[[Int16,...],...]\uFF1A\u7F13\u51B2\u7684PCM\u6570\u636E\uFF0C\u4E3A\u4ECE\u5F00\u59CB\u5F55\u97F3\u5230\u73B0\u5728\u7684\u6240\u6709pcm\u7247\u6BB5\uFF1BpowerLevel\uFF1A\u5F53\u524D\u7F13\u51B2\u7684\u97F3\u91CF\u7EA7\u522B0-100\uFF0CbufferDuration\uFF1A\u5DF2\u7F13\u51B2\u65F6\u957F\uFF0CbufferSampleRate\uFF1A\u7F13\u51B2\u4F7F\u7528\u7684\u91C7\u6837\u7387\uFF08\u5F53type\u652F\u6301\u8FB9\u5F55\u8FB9\u8F6C\u7801(Worker)\u65F6\uFF0C\u6B64\u91C7\u6837\u7387\u548C\u8BBE\u7F6E\u7684\u91C7\u6837\u7387\u76F8\u540C\uFF0C\u5426\u5219\u4E0D\u4E00\u5B9A\u76F8\u540C\uFF09\uFF1BnewBufferIdx:\u672C\u6B21\u56DE\u8C03\u65B0\u589E\u7684buffer\u8D77\u59CB\u7D22\u5F15\uFF1BasyncEnd:fn() \u5982\u679ConProcess\u662F\u5F02\u6B65\u7684(\u8FD4\u56DE\u503C\u4E3Atrue\u65F6)\uFF0C\u5904\u7406\u5B8C\u6210\u65F6\u9700\u8981\u8C03\u7528\u6B64\u56DE\u8C03\uFF0C\u5982\u679C\u4E0D\u662F\u5F02\u6B65\u7684\u8BF7\u5FFD\u7565\u6B64\u53C2\u6570\uFF0C\u6B64\u65B9\u6CD5\u56DE\u8C03\u65F6\u5FC5\u987B\u662F\u771F\u5F02\u6B65\uFF08\u4E0D\u80FD\u771F\u5F02\u6B65\u65F6\u9700\u7528setTimeout\u5305\u88F9\uFF09\u3002onProcess\u8FD4\u56DE\u503C\uFF1A\u5982\u679C\u8FD4\u56DEtrue\u4EE3\u8868\u5F00\u542F\u5F02\u6B65\u6A21\u5F0F\uFF0C\u5728\u67D0\u4E9B\u5927\u91CF\u8FD0\u7B97\u7684\u573A\u5408\u5F02\u6B65\u662F\u5FC5\u987B\u7684\uFF0C\u5FC5\u987B\u5728\u5F02\u6B65\u5904\u7406\u5B8C\u6210\u65F6\u8C03\u7528asyncEnd(\u4E0D\u80FD\u771F\u5F02\u6B65\u65F6\u9700\u7528setTimeout\u5305\u88F9)\uFF0C\u5728onProcess\u6267\u884C\u540E\u65B0\u589E\u7684buffer\u4F1A\u5168\u90E8\u66FF\u6362\u6210\u7A7A\u6570\u7EC4\uFF0C\u56E0\u6B64\u672C\u56DE\u8C03\u5F00\u5934\u5E94\u7ACB\u5373\u5C06newBufferIdx\u5230\u672C\u6B21\u56DE\u8C03\u7ED3\u5C3E\u4F4D\u7F6E\u7684buffer\u5168\u90E8\u4FDD\u5B58\u5230\u53E6\u5916\u4E00\u4E2A\u6570\u7EC4\u5185\uFF0C\u5904\u7406\u5B8C\u6210\u540E\u5199\u56DEbuffers\u4E2D\u672C\u6B21\u56DE\u8C03\u7684\u7ED3\u5C3E\u4F4D\u7F6E\u3002\n\t\t\n\t\t//*******\u9AD8\u7EA7\u8BBE\u7F6E******\n\t\t//,sourceStream:MediaStream Object\n\t\t\t\t//\u53EF\u9009\u76F4\u63A5\u63D0\u4F9B\u4E00\u4E2A\u5A92\u4F53\u6D41\uFF0C\u4ECE\u8FD9\u4E2A\u6D41\u4E2D\u5F55\u5236\u3001\u5B9E\u65F6\u5904\u7406\u97F3\u9891\u6570\u636E\uFF08\u5F53\u524DRecorder\u5B9E\u4F8B\u72EC\u4EAB\u6B64\u6D41\uFF09\uFF1B\u4E0D\u63D0\u4F9B\u65F6\u4E3A\u666E\u901A\u7684\u9EA6\u514B\u98CE\u5F55\u97F3\uFF0C\u7531getUserMedia\u63D0\u4F9B\u97F3\u9891\u6D41\uFF08\u6240\u6709Recorder\u5B9E\u4F8B\u5171\u4EAB\u540C\u4E00\u4E2A\u6D41\uFF09\n\t\t\t\t//\u6BD4\u5982\uFF1Aaudio\u3001video\u6807\u7B7Edom\u8282\u70B9\u7684captureStream\u65B9\u6CD5\uFF08\u5B9E\u9A8C\u7279\u6027\uFF0C\u4E0D\u540C\u6D4F\u89C8\u5668\u652F\u6301\u7A0B\u5EA6\u4E0D\u9AD8\uFF09\u8FD4\u56DE\u7684\u6D41\uFF1BWebRTC\u4E2D\u7684remote\u6D41\uFF1B\u81EA\u5DF1\u521B\u5EFA\u7684\u6D41\u7B49\n\t\t\t\t//\u6CE8\u610F\uFF1A\u6D41\u5185\u5FC5\u987B\u81F3\u5C11\u5B58\u5728\u4E00\u6761\u97F3\u8F68(Audio Track)\uFF0C\u6BD4\u5982audio\u6807\u7B7E\u5FC5\u987B\u7B49\u5F85\u5230\u53EF\u4EE5\u5F00\u59CB\u64AD\u653E\u540E\u624D\u4F1A\u6709\u97F3\u8F68\uFF0C\u5426\u5219open\u4F1A\u5931\u8D25\n\t\t\n\t\t//,runningContext:AudioContext\n\t\t\t\t//\u53EF\u9009\u63D0\u4F9B\u4E00\u4E2Astate\u4E3Arunning\u72B6\u6001\u7684AudioContext\u5BF9\u8C61(ctx)\uFF1B\u9ED8\u8BA4\u4F1A\u5728rec.open\u65F6\u81EA\u52A8\u521B\u5EFA\u4E00\u4E2A\u65B0\u7684ctx\uFF0C\u65E0\u7528\u6237\u64CD\u4F5C\uFF08\u89E6\u6478\u3001\u70B9\u51FB\u7B49\uFF09\u65F6\u8C03\u7528rec.open\u7684ctx.state\u53EF\u80FD\u4E3Asuspended\uFF0C\u4F1A\u5728rec.start\u65F6\u5C1D\u8BD5\u8FDB\u884Cctx.resume\uFF0C\u5982\u679C\u4E5F\u65E0\u7528\u6237\u64CD\u4F5Cctx.resume\u53EF\u80FD\u4E0D\u4F1A\u6062\u590D\u6210running\u72B6\u6001\uFF08\u76EE\u524D\u4EC5iOS\u4E0A\u6709\u6B64\u517C\u5BB9\u6027\u95EE\u9898\uFF09\uFF0C\u5BFC\u81F4\u65E0\u6CD5\u53BB\u8BFB\u53D6\u5A92\u4F53\u6D41\uFF0C\u8FD9\u65F6\u8BF7\u63D0\u524D\u5728\u7528\u6237\u64CD\u4F5C\u65F6\u8C03\u7528Recorder.GetContext(true)\u6765\u5F97\u5230\u4E00\u4E2Arunning\u72B6\u6001AudioContext\uFF08\u7528\u5B8C\u9700\u8C03\u7528CloseNewCtx(ctx)\u5173\u95ED\uFF09\n\t\t\n\t\t//,audioTrackSet:{ deviceId:\"\",groupId:\"\", autoGainControl:true, echoCancellation:true, noiseSuppression:true }\n\t\t\t\t//\u666E\u901A\u9EA6\u514B\u98CE\u5F55\u97F3\u65F6getUserMedia\u65B9\u6CD5\u7684audio\u914D\u7F6E\u53C2\u6570\uFF0C\u6BD4\u5982\u6307\u5B9A\u8BBE\u5907id\uFF0C\u56DE\u58F0\u6D88\u9664\u3001\u964D\u566A\u5F00\u5173\uFF1B\u6CE8\u610F\uFF1A\u63D0\u4F9B\u7684\u4EFB\u4F55\u914D\u7F6E\u503C\u90FD\u4E0D\u4E00\u5B9A\u4F1A\u751F\u6548\n\t\t\t\t//\u7531\u4E8E\u9EA6\u514B\u98CE\u662F\u5168\u5C40\u5171\u4EAB\u7684\uFF0C\u6240\u4EE5\u65B0\u914D\u7F6E\u540E\u9700\u8981close\u6389\u4EE5\u524D\u7684\u518D\u91CD\u65B0open\n\t\t\t\t//\u66F4\u591A\u53C2\u8003: https://developer.mozilla.org/en-US/docs/Web/API/MediaTrackConstraints\n\t\t\n\t\t//,disableEnvInFix:false \u5185\u90E8\u53C2\u6570\uFF0C\u7981\u7528\u8BBE\u5907\u5361\u987F\u65F6\u97F3\u9891\u8F93\u5165\u4E22\u5931\u8865\u507F\u529F\u80FD\n\t\t\n\t\t//,takeoffEncodeChunk:NOOP //fn(chunkBytes) chunkBytes=[Uint8,...]\uFF1A\u5B9E\u65F6\u7F16\u7801\u73AF\u5883\u4E0B\u63A5\u7BA1\u7F16\u7801\u5668\u8F93\u51FA\uFF0C\u5F53\u7F16\u7801\u5668\u5B9E\u65F6\u7F16\u7801\u51FA\u4E00\u5757\u6709\u6548\u7684\u4E8C\u8FDB\u5236\u97F3\u9891\u6570\u636E\u65F6\u5B9E\u65F6\u56DE\u8C03\u6B64\u65B9\u6CD5\uFF1B\u53C2\u6570\u4E3A\u4E8C\u8FDB\u5236\u7684Uint8Array\uFF0C\u5C31\u662F\u7F16\u7801\u51FA\u6765\u7684\u97F3\u9891\u6570\u636E\u7247\u6BB5\uFF0C\u6240\u6709\u7684chunkBytes\u62FC\u63A5\u5728\u4E00\u8D77\u5373\u4E3A\u5B8C\u6574\u97F3\u9891\u3002\u672C\u5B9E\u73B0\u7684\u60F3\u6CD5\u6700\u521D\u7531QQ2543775048\u63D0\u51FA\n\t\t\t\t//\u5F53\u63D0\u4F9B\u6B64\u56DE\u8C03\u65B9\u6CD5\u65F6\uFF0C\u5C06\u63A5\u7BA1\u7F16\u7801\u5668\u7684\u6570\u636E\u8F93\u51FA\uFF0C\u7F16\u7801\u5668\u5185\u90E8\u5C06\u653E\u5F03\u5B58\u50A8\u751F\u6210\u7684\u97F3\u9891\u6570\u636E\uFF1B\u5982\u679C\u5F53\u524D\u7F16\u7801\u5668\u6216\u73AF\u5883\u4E0D\u652F\u6301\u5B9E\u65F6\u7F16\u7801\u5904\u7406\uFF0C\u5C06\u5728open\u65F6\u76F4\u63A5\u8D70fail\u903B\u8F91\n\t\t\t\t//\u56E0\u6B64\u63D0\u4F9B\u6B64\u56DE\u8C03\u540E\u8C03\u7528stop\u65B9\u6CD5\u5C06\u65E0\u6CD5\u83B7\u5F97\u6709\u6548\u7684\u97F3\u9891\u6570\u636E\uFF0C\u56E0\u4E3A\u7F16\u7801\u5668\u5185\u6CA1\u6709\u97F3\u9891\u6570\u636E\uFF0C\u56E0\u6B64stop\u65F6\u8FD4\u56DE\u7684blob\u5C06\u662F\u4E00\u4E2A\u5B57\u8282\u957F\u5EA6\u4E3A0\u7684blob\n\t\t\t\t//\u5927\u90E8\u5206\u5F55\u97F3\u683C\u5F0F\u7F16\u7801\u5668\u90FD\u652F\u6301\u5B9E\u65F6\u7F16\u7801\uFF08\u8FB9\u5F55\u8FB9\u8F6C\u7801\uFF09\uFF0C\u6BD4\u5982mp3\u683C\u5F0F\uFF1A\u4F1A\u5B9E\u65F6\u7684\u5C06\u7F16\u7801\u51FA\u6765\u7684mp3\u7247\u6BB5\u901A\u8FC7\u6B64\u65B9\u6CD5\u56DE\u8C03\uFF0C\u6240\u6709\u7684chunkBytes\u62FC\u63A5\u5230\u4E00\u8D77\u5373\u4E3A\u5B8C\u6574\u7684mp3\uFF0C\u6B64\u79CD\u62FC\u63A5\u7684\u7ED3\u679C\u6BD4mock\u65B9\u6CD5\u5B9E\u65F6\u751F\u6210\u7684\u97F3\u8D28\u66F4\u52A0\uFF0C\u56E0\u4E3A\u5929\u7136\u907F\u514D\u4E86\u9996\u5C3E\u7684\u9759\u9ED8\n\t\t\t\t//\u4E0D\u652F\u6301\u5B9E\u65F6\u7F16\u7801\u7684\u5F55\u97F3\u683C\u5F0F\u4E0D\u53EF\u4EE5\u63D0\u4F9B\u6B64\u56DE\u8C03\uFF08wav\u683C\u5F0F\u4E0D\u652F\u6301\uFF0C\u56E0\u4E3Awav\u6587\u4EF6\u5934\u4E2D\u9700\u8981\u63D0\u4F9B\u6587\u4EF6\u6700\u7EC8\u957F\u5EA6\uFF09\uFF0C\u63D0\u4F9B\u4E86\u5C06\u5728open\u65F6\u76F4\u63A5\u8D70fail\u903B\u8F91\n\t};\n\t\n\tfor(var k in set){\n\t\to[k]=set[k];\n\t};\n\tThis.set=o;\n\t\n\tvar vB=o[bitRateTxt],vS=o[sampleRateTxt]; //\u6821\u9A8C\u914D\u7F6E\u53C2\u6570\n\tif(vB&&!IsNum(vB) || vS&&!IsNum(vS)){\n\t\tThis.CLog($T.G(\"IllegalArgs-1\",[$T(\"VtS4::{1}\u548C{2}\u5FC5\u987B\u662F\u6570\u503C\",0,sampleRateTxt,bitRateTxt)]),1,set);\n\t};\n\to[bitRateTxt]=+vB||16;\n\to[sampleRateTxt]=+vS||16000;\n\t\n\tThis.state=0;//\u8FD0\u884C\u72B6\u6001\uFF0C0\u672A\u5F55\u97F3 1\u5F55\u97F3\u4E2D 2\u6682\u505C 3\u7B49\u5F85ctx\u6FC0\u6D3B\n\tThis._S=9;//stop\u540C\u6B65\u9501\uFF0Cstop\u53EF\u4EE5\u963B\u6B62open\u8FC7\u7A0B\u4E2D\u8FD8\u672A\u8FD0\u884C\u7684start\n\tThis.Sync={O:9,C:9};//\u548CRecorder.Sync\u4E00\u81F4\uFF0C\u53EA\u4E0D\u8FC7\u8FD9\u4E2A\u662F\u975E\u5168\u5C40\u7684\uFF0C\u4EC5\u7528\u6765\u7B80\u5316\u4EE3\u7801\u903B\u8F91\uFF0C\u65E0\u5B9E\u9645\u4F5C\u7528\n};\n//\u540C\u6B65\u9501\uFF0C\u63A7\u5236\u5BF9Stream\u7684\u7ADE\u4E89\uFF1B\u7528\u4E8Eclose\u65F6\u4E2D\u65AD\u5F02\u6B65\u7684open\uFF1B\u4E00\u4E2A\u5BF9\u8C61open\u5982\u679C\u53D8\u5316\u4E86\u90FD\u8981\u963B\u6B62close\uFF0CStream\u7684\u63A7\u5236\u6743\u4EA4\u4E2A\u65B0\u7684\u5BF9\u8C61\nRecorder.Sync={/*open*/O:9,/*close*/C:9};\n\nRecorder.prototype=initFn.prototype={\n\tCLog:CLog\n\t\n\t//\u6D41\u76F8\u5173\u7684\u6570\u636E\u5B58\u50A8\u5728\u54EA\u4E2A\u5BF9\u8C61\u91CC\u9762\uFF1B\u5982\u679C\u63D0\u4F9B\u4E86sourceStream\uFF0C\u6570\u636E\u76F4\u63A5\u5B58\u50A8\u5728\u5F53\u524D\u5BF9\u8C61\u4E2D\uFF0C\u5426\u5219\u5B58\u50A8\u5728\u5168\u5C40\n\t,_streamStore:function(){\n\t\tif(this.set.sourceStream){\n\t\t\treturn this;\n\t\t}else{\n\t\t\treturn Recorder;\n\t\t}\n\t}\n\t//\u5F53\u524D\u5B9E\u4F8B\u7528\u5230\u7684AudioContext\uFF0C\u53EF\u80FD\u662F\u5168\u5C40\u7684\uFF0C\u4E5F\u53EF\u80FD\u662F\u72EC\u4EAB\u7684\n\t,_streamCtx:function(){\n\t\tvar m=this._streamStore().Stream;\n\t\treturn m&&m._c;\n\t}\n\t\n\t//\u6253\u5F00\u5F55\u97F3\u8D44\u6E90True(),False(msg,isUserNotAllow)\uFF0C\u9700\u8981\u8C03\u7528close\u3002\u6CE8\u610F\uFF1A\u6B64\u65B9\u6CD5\u662F\u5F02\u6B65\u7684\uFF1B\u4E00\u822C\u4F7F\u7528\u65F6\u6253\u5F00\uFF0C\u7528\u5B8C\u7ACB\u5373\u5173\u95ED\uFF1B\u53EF\u91CD\u590D\u8C03\u7528\uFF0C\u53EF\u7528\u6765\u6D4B\u8BD5\u662F\u5426\u80FD\u5F55\u97F3\uFF1Bopen\u548Cstart\u81F3\u5C11\u6709\u4E00\u4E2A\u5E94\u5F53\u5728\u7528\u6237\u64CD\u4F5C\uFF08\u89E6\u6478\u3001\u70B9\u51FB\u7B49\uFF09\u4E0B\u8FDB\u884C\u8C03\u7528\uFF0C\u539F\u56E0\u53C2\u8003runningContext\u914D\u7F6E\n\t,open:function(True,False){\n\t\tvar This=this,set=This.set,streamStore=This._streamStore(),newCtx=0;\n\t\tTrue=True||NOOP;\n\t\tvar failCall=function(errMsg,isUserNotAllow){\n\t\t\tisUserNotAllow=!!isUserNotAllow;\n\t\t\tThis.CLog($T(\"5tWi::\u5F55\u97F3open\u5931\u8D25\uFF1A\")+errMsg+\",isUserNotAllow:\"+isUserNotAllow,1);\n\t\t\tif(newCtx)Recorder.CloseNewCtx(newCtx);\n\t\t\tFalse&&False(errMsg,isUserNotAllow);\n\t\t};\n\t\t\n\t\tThis._streamTag=getUserMediaTxt;\n\t\tvar ok=function(){\n\t\t\tThis.CLog(\"open ok, id:\"+This.id+\" stream:\"+This._streamTag);\n\t\t\tTrue();\n\t\t\t\n\t\t\tThis._SO=0;//\u89E3\u9664stop\u5BF9open\u4E2D\u7684start\u8C03\u7528\u7684\u963B\u6B62\n\t\t};\n\t\t\n\t\t\n\t\t//\u540C\u6B65\u9501\n\t\tvar Lock=streamStore.Sync;\n\t\tvar lockOpen=++Lock.O,lockClose=Lock.C;\n\t\tThis._O=This._O_=lockOpen;//\u8BB0\u4F4F\u5F53\u524D\u7684open\uFF0C\u5982\u679C\u53D8\u5316\u4E86\u8981\u963B\u6B62close\uFF0C\u8FD9\u91CC\u5047\u5B9A\u4E86\u65B0\u5BF9\u8C61\u5DF2\u53D6\u4EE3\u5F53\u524D\u5BF9\u8C61\u5E76\u4E14\u4E0D\u518D\u4F7F\u7528\n\t\tThis._SO=This._S;//\u8BB0\u4F4Fopen\u8FC7\u7A0B\u4E2D\u7684stop\uFF0C\u4E2D\u9014\u4EFB\u4F55stop\u8C03\u7528\u540E\u90FD\u4E0D\u80FD\u7EE7\u7EEDopen\u4E2D\u7684start\n\t\tvar lockFail=function(){\n\t\t\t//\u5141\u8BB8\u591A\u6B21open\uFF0C\u4F46\u4E0D\u5141\u8BB8\u4EFB\u4F55\u4E00\u6B21close\uFF0C\u6216\u8005\u81EA\u8EAB\u5DF2\u7ECF\u8C03\u7528\u4E86\u5173\u95ED\n\t\t\tif(lockClose!=Lock.C || !This._O){\n\t\t\t\tvar err=$T(\"dFm8::open\u88AB\u53D6\u6D88\");\n\t\t\t\tif(lockOpen==Lock.O){\n\t\t\t\t\t//\u65E0\u65B0\u7684open\uFF0C\u5DF2\u7ECF\u8C03\u7528\u4E86close\u8FDB\u884C\u53D6\u6D88\uFF0C\u6B64\u5904\u5E94\u8BA9\u4E0A\u6B21\u7684close\u660E\u786E\u751F\u6548\n\t\t\t\t\tThis.close();\n\t\t\t\t}else{\n\t\t\t\t\terr=$T(\"VtJO::open\u88AB\u4E2D\u65AD\");\n\t\t\t\t};\n\t\t\t\tfailCall(err);\n\t\t\t\treturn true;\n\t\t\t};\n\t\t};\n\t\t\n\t\t//\u73AF\u5883\u914D\u7F6E\u68C0\u67E5\n\t\tif(!isBrowser){\n\t\t\tfailCall($T.G(\"NonBrowser-1\",[\"open\"])+$T(\"EMJq::\uFF0C\u53EF\u5C1D\u8BD5\u4F7F\u7528RecordApp\u89E3\u51B3\u65B9\u6848\")+\"(\"+GitUrl+\"/tree/master/app-support-sample)\");\n\t\t\treturn;\n\t\t};\n\t\tvar checkMsg=This.envCheck({envName:\"H5\",canProcess:true});\n\t\tif(checkMsg){\n\t\t\tfailCall($T(\"A5bm::\u4E0D\u80FD\u5F55\u97F3\uFF1A\")+checkMsg);\n\t\t\treturn;\n\t\t};\n\t\t\n\t\t\n\t\t//***********\u5DF2\u76F4\u63A5\u63D0\u4F9B\u4E86\u97F3\u9891\u6D41************\n\t\tif(set.sourceStream){\n\t\t\tThis._streamTag=\"set.sourceStream\";\n\t\t\tif(!Recorder.GetContext()){\n\t\t\t\tfailCall($T(\"1iU7::\u4E0D\u652F\u6301\u6B64\u6D4F\u89C8\u5668\u4ECE\u6D41\u4E2D\u83B7\u53D6\u5F55\u97F3\"));\n\t\t\t\treturn;\n\t\t\t};\n\t\t\t\n\t\t\tDisconnect(streamStore);//\u53EF\u80FD\u5DF2open\u8FC7\uFF0C\u76F4\u63A5\u5148\u5C1D\u8BD5\u65AD\u5F00\n\t\t\tvar stream=This.Stream=set.sourceStream;\n\t\t\tstream._RC=set.runningContext;\n\t\t\tstream._call={};\n\t\t\t\n\t\t\ttry{\n\t\t\t\tConnect(streamStore);\n\t\t\t}catch(e){\n\t\t\t\tDisconnect(streamStore);\n\t\t\t\tfailCall($T(\"BTW2::\u4ECE\u6D41\u4E2D\u6253\u5F00\u5F55\u97F3\u5931\u8D25\uFF1A\")+e.message);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tok();\n\t\t\treturn;\n\t\t};\n\t\t\n\t\t\n\t\t//***********\u6253\u5F00\u9EA6\u514B\u98CE\u5F97\u5230\u5168\u5C40\u7684\u97F3\u9891\u6D41************\n\t\tvar codeFail=function(code,msg){\n\t\t\ttry{//\u8DE8\u57DF\u7684\u4F18\u5148\u68C0\u6D4B\u4E00\u4E0B\n\t\t\t\twindow.top.a;\n\t\t\t}catch(e){\n\t\t\t\tfailCall($T(\"Nclz::\u65E0\u6743\u5F55\u97F3(\u8DE8\u57DF\uFF0C\u8BF7\u5C1D\u8BD5\u7ED9iframe\u6DFB\u52A0\u9EA6\u514B\u98CE\u8BBF\u95EE\u7B56\u7565\uFF0C\u5982{1})\",0,'allow=\"camera;microphone\"'));\n\t\t\t\treturn;\n\t\t\t};\n\t\t\t\n\t\t\tif(/Permission|Allow/i.test(code)){\n\t\t\t\tfailCall($T(\"gyO5::\u7528\u6237\u62D2\u7EDD\u4E86\u5F55\u97F3\u6743\u9650\"),true);\n\t\t\t}else if(window.isSecureContext===false){\n\t\t\t\tfailCall($T(\"oWNo::\u6D4F\u89C8\u5668\u7981\u6B62\u4E0D\u5B89\u5168\u9875\u9762\u5F55\u97F3\uFF0C\u53EF\u5F00\u542Fhttps\u89E3\u51B3\"));\n\t\t\t}else if(/Found/i.test(code)){//\u53EF\u80FD\u662F\u975E\u5B89\u5168\u73AF\u5883\u5BFC\u81F4\u7684\u6CA1\u6709\u8BBE\u5907\n\t\t\t\tfailCall(msg+$T(\"jBa9::\uFF0C\u65E0\u53EF\u7528\u9EA6\u514B\u98CE\"));\n\t\t\t}else{\n\t\t\t\tfailCall(msg);\n\t\t\t};\n\t\t};\n\t\t\n\t\t\n\t\t//\u5982\u679C\u5DF2\u6253\u5F00\u5E76\u4E14\u6709\u6548\u5C31\u4E0D\u8981\u518D\u6253\u5F00\u4E86\n\t\tif(Recorder.IsOpen()){\n\t\t\tok();\n\t\t\treturn;\n\t\t};\n\t\tif(!Recorder.Support()){\n\t\t\tcodeFail(\"\",$T(\"COxc::\u6B64\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u5F55\u97F3\"));\n\t\t\treturn;\n\t\t};\n\t\t//\u5C3D\u91CF\u5148\u521B\u5EFA\u597Dctx\uFF0C\u4E0D\u7136\u5F02\u6B65\u4E0B\u521B\u5EFA\u53EF\u80FD\u4E0D\u662Frunning\u72B6\u6001\n\t\tvar ctx=set.runningContext;\n\t\tif(!ctx)ctx=newCtx=Recorder.GetContext(true);\n\t\t\n\t\t//\u8BF7\u6C42\u6743\u9650\uFF0C\u5982\u679C\u4ECE\u672A\u6388\u6743\uFF0C\u4E00\u822C\u6D4F\u89C8\u5668\u4F1A\u5F39\u51FA\u6743\u9650\u8BF7\u6C42\u5F39\u6846\n\t\tvar f1=function(stream){\n\t\t\t//https://github.com/xiangyuecn/Recorder/issues/14 \u83B7\u53D6\u5230\u7684track.readyState!=\"live\"\uFF0C\u521A\u521A\u56DE\u8C03\u65F6\u53EF\u80FD\u662F\u6B63\u5E38\u7684\uFF0C\u4F46\u8FC7\u4E00\u4E0B\u53EF\u80FD\u5C31\u88AB\u5173\u6389\u4E86\uFF0C\u539F\u56E0\u4E0D\u660E\u3002\u5EF6\u8FDF\u4E00\u4E0B\u4FDD\u8BC1\u771F\u5F02\u6B65\u3002\u5BF9\u6B63\u5E38\u6D4F\u89C8\u5668\u4E0D\u5F71\u54CD\n\t\t\tsetTimeout(function(){\n\t\t\t\tstream._call={};\n\t\t\t\tvar oldStream=Recorder.Stream;\n\t\t\t\tif(oldStream){\n\t\t\t\t\tDisconnect(); //\u76F4\u63A5\u65AD\u5F00\u5DF2\u5B58\u5728\u7684\uFF0C\u65E7\u7684Connect\u672A\u5B8C\u6210\u4F1A\u81EA\u52A8\u7EC8\u6B62\n\t\t\t\t\tstream._call=oldStream._call;\n\t\t\t\t};\n\t\t\t\tRecorder.Stream=stream;\n\t\t\t\tstream._c=ctx;\n\t\t\t\tstream._RC=set.runningContext;\n\t\t\t\tif(lockFail())return;\n\t\t\t\t\n\t\t\t\tif(Recorder.IsOpen()){\n\t\t\t\t\tif(oldStream)This.CLog($T(\"upb8::\u53D1\u73B0\u540C\u65F6\u591A\u6B21\u8C03\u7528open\"),1);\n\t\t\t\t\t\n\t\t\t\t\tConnect(streamStore,1);\n\t\t\t\t\tok();\n\t\t\t\t}else{\n\t\t\t\t\tfailCall($T(\"Q1GA::\u5F55\u97F3\u529F\u80FD\u65E0\u6548\uFF1A\u65E0\u97F3\u9891\u6D41\"));\n\t\t\t\t};\n\t\t\t},100);\n\t\t};\n\t\tvar f2=function(e){\n\t\t\tvar code=e.name||e.message||e.code+\":\"+e;\n\t\t\tThis.CLog($T(\"xEQR::\u8BF7\u6C42\u5F55\u97F3\u6743\u9650\u9519\u8BEF\"),1,e);\n\t\t\t\n\t\t\tcodeFail(code,$T(\"bDOG::\u65E0\u6CD5\u5F55\u97F3\uFF1A\")+code);\n\t\t};\n\t\t\n\t\tvar trackSet=set.audioTrackSet||{};\n\t\ttrackSet[sampleRateTxt]=ctx[sampleRateTxt];//\u5FC5\u987B\u6307\u660E\u91C7\u6837\u7387\uFF0C\u4E0D\u7136\u624B\u673A\u4E0AMediaRecorder\u91C7\u6837\u738716k\n\t\t\n\t\tvar mSet={audio:trackSet};\n\t\ttry{\n\t\t\tvar pro=Recorder.Scope[getUserMediaTxt](mSet,f1,f2);\n\t\t}catch(e){//\u4E0D\u80FD\u8BBE\u7F6EtrackSet\u5C31\u7B97\u4E86\n\t\t\tThis.CLog(getUserMediaTxt,3,e);\n\t\t\tmSet={audio:true};\n\t\t\tpro=Recorder.Scope[getUserMediaTxt](mSet,f1,f2);\n\t\t};\n\t\tThis.CLog(getUserMediaTxt+\"(\"+JSON.stringify(mSet)+\") \"+CtxState(ctx)\n\t\t\t+$T(\"RiWe::\uFF0C\u672A\u914D\u7F6EnoiseSuppression\u548CechoCancellation\u65F6\u6D4F\u89C8\u5668\u53EF\u80FD\u4F1A\u81EA\u52A8\u6253\u5F00\u964D\u566A\u548C\u56DE\u58F0\u6D88\u9664\uFF0C\u79FB\u52A8\u7AEF\u53EF\u80FD\u4F1A\u964D\u4F4E\u7CFB\u7EDF\u64AD\u653E\u97F3\u91CF\uFF08\u5173\u95ED\u5F55\u97F3\u540E\u53EF\u6062\u590D\uFF09\uFF0C\u8BF7\u53C2\u9605\u6587\u6863\u4E2DaudioTrackSet\u914D\u7F6E\")\n\t\t\t+\"(\"+GitUrl+\") LM:\"+LM+\" UA:\"+navigator.userAgent);\n\t\tif(pro&&pro.then){\n\t\t\tpro.then(f1)[CatchTxt](f2); //fix \u5173\u952E\u5B57\uFF0C\u4FDD\u8BC1catch\u538B\u7F29\u65F6\u4FDD\u6301\u5B57\u7B26\u4E32\u5F62\u5F0F\n\t\t};\n\t}\n\t//\u5173\u95ED\u91CA\u653E\u5F55\u97F3\u8D44\u6E90\n\t,close:function(call){\n\t\tcall=call||NOOP;\n\t\t\n\t\tvar This=this,streamStore=This._streamStore();\n\t\tThis._stop();\n\t\tvar sTag=\" stream:\"+This._streamTag;\n\t\t\n\t\tvar Lock=streamStore.Sync;\n\t\tThis._O=0;\n\t\tif(This._O_!=Lock.O){\n\t\t\t//\u552F\u4E00\u8D44\u6E90Stream\u7684\u63A7\u5236\u6743\u5DF2\u4EA4\u7ED9\u65B0\u5BF9\u8C61\uFF0C\u8FD9\u91CC\u4E0D\u80FD\u5173\u95ED\u3002\u6B64\u5904\u5728\u6BCF\u6B21\u90FD\u5F39\u6743\u9650\u7684\u6D4F\u89C8\u5668\u5185\u53EF\u80FD\u5B58\u5728\u6CC4\u6F0F\uFF0C\u65B0\u5BF9\u8C61\u88AB\u62D2\u7EDD\u6743\u9650\u53EF\u80FD\u4E0D\u4F1A\u8C03\u7528close\uFF0C\u5FFD\u7565\u8FD9\u79CD\u4E0D\u5904\u7406\n\t\t\tThis.CLog($T(\"hWVz::close\u88AB\u5FFD\u7565\uFF08\u56E0\u4E3A\u540C\u65F6open\u4E86\u591A\u4E2Arec\uFF0C\u53EA\u6709\u6700\u540E\u4E00\u4E2A\u4F1A\u771F\u6B63close\uFF09\")+sTag,3);\n\t\t\tcall();\n\t\t\treturn;\n\t\t};\n\t\tLock.C++;//\u83B7\u5F97\u63A7\u5236\u6743\n\t\t\n\t\tDisconnect(streamStore);\n\t\t\n\t\tThis.CLog(\"close,\"+sTag);\n\t\tcall();\n\t}\n\t\n\t\n\t\n\t\n\t\n\t/*\u6A21\u62DF\u4E00\u6BB5\u5F55\u97F3\u6570\u636E\uFF0C\u540E\u9762\u53EF\u4EE5\u8C03\u7528stop\u8FDB\u884C\u7F16\u7801\uFF0C\u9700\u63D0\u4F9Bpcm\u6570\u636E[1,2,3...]\uFF0Cpcm\u7684\u91C7\u6837\u7387*/\n\t,mock:function(pcmData,pcmSampleRate){\n\t\tvar This=this;\n\t\tThis._stop();//\u6E05\u7406\u6389\u5DF2\u6709\u7684\u8D44\u6E90\n\t\t\n\t\tThis.isMock=1;\n\t\tThis.mockEnvInfo=null;\n\t\tThis.buffers=[pcmData];\n\t\tThis.recSize=pcmData.length;\n\t\tThis._setSrcSR(pcmSampleRate);\n\t\tThis._streamTag=\"mock\";\n\t\treturn This;\n\t}\n\t,_setSrcSR:function(sampleRate){\n\t\tvar This=this,set=This.set;\n\t\tvar setSr=set[sampleRateTxt];\n\t\tif(setSr>sampleRate){\n\t\t\tset[sampleRateTxt]=sampleRate;\n\t\t}else{ setSr=0 }\n\t\tThis[srcSampleRateTxt]=sampleRate;\n\t\tThis.CLog(srcSampleRateTxt+\": \"+sampleRate+\" set.\"+sampleRateTxt+\": \"+set[sampleRateTxt]+(setSr?\" \"+$T(\"UHvm::\u5FFD\u7565\")+\": \"+setSr:\"\"), setSr?3:0);\n\t}\n\t,envCheck:function(envInfo){//\u5E73\u53F0\u73AF\u5883\u4E0B\u7684\u53EF\u7528\u6027\u68C0\u67E5\uFF0C\u4EFB\u4F55\u65F6\u5019\u90FD\u53EF\u4EE5\u8C03\u7528\u68C0\u67E5\uFF0C\u8FD4\u56DEerrMsg:\"\"\u6B63\u5E38\uFF0C\"\u5931\u8D25\u539F\u56E0\"\n\t\t//envInfo={envName:\"H5\",canProcess:true}\n\t\tvar errMsg,This=this,set=This.set;\n\t\t\n\t\t//\u68C0\u6D4BCPU\u7684\u6570\u5B57\u5B57\u8282\u5E8F\uFF0CTypedArray\u5B57\u8282\u5E8F\u662F\u4E2A\u8FF7\uFF0C\u76F4\u63A5\u62D2\u7EDD\u7F55\u89C1\u7684\u5927\u7AEF\u6A21\u5F0F\uFF0C\u56E0\u4E3A\u627E\u4E0D\u5230\u8FD9\u79CDCPU\u8FDB\u884C\u6D4B\u8BD5\n\t\tvar tag=\"CPU_BE\";\n\t\tif(!errMsg && !Recorder[tag] && typeof Int8Array==\"function\" && !new Int8Array(new Int32Array([1]).buffer)[0]){\n\t\t\tTraffic(tag); //\u5982\u679C\u5F00\u542F\u4E86\u6D41\u91CF\u7EDF\u8BA1\uFF0C\u8FD9\u91CC\u5C06\u53D1\u9001\u4E00\u4E2A\u56FE\u7247\u8BF7\u6C42\n\t\t\terrMsg=$T(\"Essp::\u4E0D\u652F\u6301{1}\u67B6\u6784\",0,tag);\n\t\t};\n\t\t\n\t\t//\u7F16\u7801\u5668\u68C0\u67E5\u73AF\u5883\u4E0B\u914D\u7F6E\u662F\u5426\u53EF\u7528\n\t\tif(!errMsg){\n\t\t\tvar type=set.type,hasFn=This[type+\"_envCheck\"];\n\t\t\tif(set.takeoffEncodeChunk){//\u9700\u8981\u5B9E\u65F6\u7F16\u7801\u8FD4\u56DE\u6570\u636E\uFF0C\u6B64\u65F6\u9700\u8981\u68C0\u67E5\u73AF\u5883\u662F\u5426\u6709\u5B9E\u65F6\u7279\u6027\u3001\u548C\u662F\u5426\u53EF\u5B9E\u65F6\u7F16\u7801\n\t\t\t\tif(!hasFn){\n\t\t\t\t\terrMsg=$T(\"2XBl::{1}\u7C7B\u578B\u4E0D\u652F\u6301\u8BBE\u7F6EtakeoffEncodeChunk\",0,type)+(This[type]?\"\":$T(\"LG7e::(\u672A\u52A0\u8F7D\u7F16\u7801\u5668)\"));\n\t\t\t\t}else if(!envInfo.canProcess){\n\t\t\t\t\terrMsg=$T(\"7uMV::{1}\u73AF\u5883\u4E0D\u652F\u6301\u5B9E\u65F6\u5904\u7406\",0,envInfo.envName);\n\t\t\t\t};\n\t\t\t};\n\t\t\t\n\t\t\tif(!errMsg && hasFn){//\u7F16\u7801\u5668\u5DF2\u5B9E\u73B0\u73AF\u5883\u68C0\u67E5\n\t\t\t\terrMsg=This[type+\"_envCheck\"](envInfo,set);\n\t\t\t};\n\t\t};\n\t\t\n\t\treturn errMsg||\"\";\n\t}\n\t,envStart:function(mockEnvInfo,sampleRate){//\u5E73\u53F0\u73AF\u5883\u76F8\u5173\u7684start\u8C03\u7528\n\t\tvar This=this,set=This.set;\n\t\tThis.isMock=mockEnvInfo?1:0;//\u975EH5\u73AF\u5883\u9700\u8981\u542F\u7528mock\uFF0C\u5E76\u63D0\u4F9BenvCheck\u9700\u8981\u7684\u73AF\u5883\u4FE1\u606F\n\t\tThis.mockEnvInfo=mockEnvInfo;\n\t\tThis.buffers=[];//\u6570\u636E\u7F13\u51B2\n\t\tThis.recSize=0;//\u6570\u636E\u5927\u5C0F\n\t\tif(mockEnvInfo){\n\t\t\tThis._streamTag=\"env$\"+mockEnvInfo.envName;\n\t\t};\n\t\t\n\t\tThis.state=1;//\u8FD0\u884C\u72B6\u6001\uFF0C0\u672A\u5F55\u97F3 1\u5F55\u97F3\u4E2D 2\u6682\u505C 3\u7B49\u5F85ctx\u6FC0\u6D3B\n\t\tThis.envInLast=0;//envIn\u63A5\u6536\u5230\u6700\u540E\u5F55\u97F3\u5185\u5BB9\u7684\u65F6\u95F4\n\t\tThis.envInFirst=0;//envIn\u63A5\u6536\u5230\u7684\u9996\u4E2A\u5F55\u97F3\u5185\u5BB9\u7684\u5F55\u5236\u65F6\u95F4\n\t\tThis.envInFix=0;//\u8865\u507F\u7684\u603B\u65F6\u95F4\n\t\tThis.envInFixTs=[];//\u8865\u507F\u8BA1\u6570\u5217\u8868\n\t\t\n\t\t//engineCtx\u9700\u8981\u63D0\u524D\u786E\u5B9A\u6700\u7EC8\u7684\u91C7\u6837\u7387\n\t\tThis._setSrcSR(sampleRate);\n\t\t\n\t\tThis.engineCtx=0;\n\t\t//\u6B64\u7C7B\u578B\u6709\u8FB9\u5F55\u8FB9\u8F6C\u7801(Worker)\u652F\u6301\n\t\tif(This[set.type+\"_start\"]){\n\t\t\tvar engineCtx=This.engineCtx=This[set.type+\"_start\"](set);\n\t\t\tif(engineCtx){\n\t\t\t\tengineCtx.pcmDatas=[];\n\t\t\t\tengineCtx.pcmSize=0;\n\t\t\t};\n\t\t};\n\t}\n\t,envResume:function(){//\u548C\u5E73\u53F0\u73AF\u5883\u65E0\u5173\u7684\u6062\u590D\u5F55\u97F3\n\t\t//\u91CD\u65B0\u5F00\u59CB\u8BA1\u6570\n\t\tthis.envInFixTs=[];\n\t}\n\t,envIn:function(pcm,sum){//\u548C\u5E73\u53F0\u73AF\u5883\u65E0\u5173\u7684pcm[Int16]\u8F93\u5165\n\t\tvar This=this,set=This.set,engineCtx=This.engineCtx;\n\t\tif(This.state!=1){\n\t\t\tif(!This.state)This.CLog(\"envIn at state=0\",3);\n\t\t\treturn;\n\t\t};\n\t\tvar bufferSampleRate=This[srcSampleRateTxt];\n\t\tvar size=pcm.length;\n\t\tvar powerLevel=Recorder.PowerLevel(sum,size);\n\t\t\n\t\tvar buffers=This.buffers;\n\t\tvar bufferFirstIdx=buffers.length;//\u4E4B\u524D\u7684buffer\u90FD\u662F\u7ECF\u8FC7onProcess\u5904\u7406\u597D\u7684\uFF0C\u4E0D\u5141\u8BB8\u518D\u4FEE\u6539\n\t\tbuffers.push(pcm);\n\t\t\n\t\t//\u6709engineCtx\u65F6\u4F1A\u88AB\u8986\u76D6\uFF0C\u8FD9\u91CC\u4FDD\u5B58\u4E00\u4EFD\n\t\tvar buffersThis=buffers;\n\t\tvar bufferFirstIdxThis=bufferFirstIdx;\n\t\t\n\t\t//\u5361\u987F\u4E22\u5931\u8865\u507F\uFF1A\u56E0\u4E3A\u8BBE\u5907\u5F88\u5361\u7684\u65F6\u5019\u5BFC\u81F4H5\u63A5\u6536\u5230\u7684\u6570\u636E\u91CF\u4E0D\u591F\u9020\u6210\u64AD\u653E\u65F6\u5019\u53D8\u901F\uFF0C\u7ED3\u679C\u6BD4\u5B9E\u9645\u7684\u65F6\u957F\u8981\u77ED\uFF0C\u6B64\u5904\u4FDD\u8BC1\u4E86\u4E0D\u4F1A\u53D8\u77ED\uFF0C\u4F46\u4E0D\u80FD\u4FEE\u590D\u4E22\u5931\u7684\u97F3\u9891\u6570\u636E\u9020\u6210\u97F3\u8D28\u53D8\u5DEE\u3002\u5F53\u524D\u7B97\u6CD5\u91C7\u7528\u8F93\u5165\u65F6\u95F4\u4FA6\u6D4B\u4E0B\u4E00\u5E27\u662F\u5426\u9700\u8981\u6DFB\u52A0\u8865\u507F\u5E27\uFF0C\u9700\u8981(6\u6B21\u8F93\u5165||\u8D85\u8FC71\u79D2)\u4EE5\u4E0A\u624D\u4F1A\u5F00\u59CB\u4FA6\u6D4B\uFF0C\u5982\u679C\u6ED1\u52A8\u7A97\u53E3\u5185\u4E22\u5931\u8D85\u8FC71/3\u5C31\u4F1A\u8FDB\u884C\u8865\u507F\n\t\tvar now=Date.now();\n\t\tvar pcmTime=Math.round(size/bufferSampleRate*1000);\n\t\tThis.envInLast=now;\n\t\tif(This.buffers.length==1){//\u8BB0\u4E0B\u9996\u4E2A\u5F55\u97F3\u6570\u636E\u7684\u5F55\u5236\u65F6\u95F4\n\t\t\tThis.envInFirst=now-pcmTime;\n\t\t};\n\t\tvar envInFixTs=This.envInFixTs;\n\t\tenvInFixTs.splice(0,0,{t:now,d:pcmTime});\n\t\t//\u4FDD\u75593\u79D2\u7684\u8BA1\u6570\u6ED1\u52A8\u7A97\u53E3\uFF0C\u53E6\u5916\u8D85\u8FC73\u79D2\u7684\u505C\u987F\u4E0D\u8865\u507F\n\t\tvar tsInStart=now,tsPcm=0;\n\t\tfor(var i=0;i<envInFixTs.length;i++){\n\t\t\tvar o=envInFixTs[i];\n\t\t\tif(now-o.t>3000){\n\t\t\t\tenvInFixTs.length=i;\n\t\t\t\tbreak;\n\t\t\t};\n\t\t\ttsInStart=o.t;\n\t\t\ttsPcm+=o.d;\n\t\t};\n\t\t//\u8FBE\u5230\u9700\u8981\u7684\u6570\u636E\u91CF\uFF0C\u5F00\u59CB\u4FA6\u6D4B\u662F\u5426\u9700\u8981\u8865\u507F\n\t\tvar tsInPrev=envInFixTs[1];\n\t\tvar tsIn=now-tsInStart;\n\t\tvar lost=tsIn-tsPcm;\n\t\tif( lost>tsIn/3 && (tsInPrev&&tsIn>1000 || envInFixTs.length>=6) ){\n\t\t\t//\u4E22\u5931\u8FC7\u591A\uFF0C\u5F00\u59CB\u6267\u884C\u8865\u507F\n\t\t\tvar addTime=now-tsInPrev.t-pcmTime;//\u8DDD\u79BB\u4E0A\u6B21\u8F93\u5165\u4E22\u5931\u8FD9\u4E48\u591Ams\n\t\t\tif(addTime>pcmTime/5){//\u4E22\u5931\u8D85\u8FC7\u672C\u5E27\u76841/5\n\t\t\t\tvar fixOpen=!set.disableEnvInFix;\n\t\t\t\tThis.CLog(\"[\"+now+\"]\"+i18n.get(fixOpen?$T(\"4Kfd::\u8865\u507F{1}ms\",1):$T(\"bM5i::\u672A\u8865\u507F{1}ms\",1),[addTime]),3);\n\t\t\t\tThis.envInFix+=addTime;\n\t\t\t\t\n\t\t\t\t//\u7528\u9759\u9ED8\u8FDB\u884C\u8865\u507F\n\t\t\t\tif(fixOpen){\n\t\t\t\t\tvar addPcm=new Int16Array(addTime*bufferSampleRate/1000);\n\t\t\t\t\tsize+=addPcm.length;\n\t\t\t\t\tbuffers.push(addPcm);\n\t\t\t\t};\n\t\t\t};\n\t\t};\n\t\t\n\t\t\n\t\tvar sizeOld=This.recSize,addSize=size;\n\t\tvar bufferSize=sizeOld+addSize;\n\t\tThis.recSize=bufferSize;//\u6B64\u503C\u5728onProcess\u540E\u9700\u8981\u4FEE\u6B63\uFF0C\u53EF\u80FD\u65B0\u6570\u636E\u88AB\u4FEE\u6539\n\t\t\n\t\t\n\t\t//\u6B64\u7C7B\u578B\u6709\u8FB9\u5F55\u8FB9\u8F6C\u7801(Worker)\u652F\u6301\uFF0C\u5F00\u542F\u5B9E\u65F6\u8F6C\u7801\n\t\tif(engineCtx){\n\t\t\t//\u8F6C\u6362\u6210set\u7684\u91C7\u6837\u7387\n\t\t\tvar chunkInfo=Recorder.SampleData(buffers,bufferSampleRate,set[sampleRateTxt],engineCtx.chunkInfo);\n\t\t\tengineCtx.chunkInfo=chunkInfo;\n\t\t\t\n\t\t\tsizeOld=engineCtx.pcmSize;\n\t\t\taddSize=chunkInfo.data.length;\n\t\t\tbufferSize=sizeOld+addSize;\n\t\t\tengineCtx.pcmSize=bufferSize;//\u6B64\u503C\u5728onProcess\u540E\u9700\u8981\u4FEE\u6B63\uFF0C\u53EF\u80FD\u65B0\u6570\u636E\u88AB\u4FEE\u6539\n\t\t\t\n\t\t\tbuffers=engineCtx.pcmDatas;\n\t\t\tbufferFirstIdx=buffers.length;\n\t\t\tbuffers.push(chunkInfo.data);\n\t\t\tbufferSampleRate=chunkInfo[sampleRateTxt];\n\t\t};\n\t\t\n\t\tvar duration=Math.round(bufferSize/bufferSampleRate*1000);\n\t\tvar bufferNextIdx=buffers.length;\n\t\tvar bufferNextIdxThis=buffersThis.length;\n\t\t\n\t\t//\u5141\u8BB8\u5F02\u6B65\u5904\u7406buffer\u6570\u636E\n\t\tvar asyncEnd=function(){\n\t\t\t//\u91CD\u65B0\u8BA1\u7B97size\uFF0C\u5F02\u6B65\u7684\u65E9\u5DF2\u51CF\u53BB\u6DFB\u52A0\u7684\uFF0C\u540C\u6B65\u7684\u9700\u53BB\u6389\u672C\u6B21\u6DFB\u52A0\u7684\u7136\u540E\u91CD\u65B0\u8BA1\u7B97\n\t\t\tvar num=asyncBegin?0:-addSize;\n\t\t\tvar hasClear=buffers[0]==null;\n\t\t\tfor(var i=bufferFirstIdx;i<bufferNextIdx;i++){\n\t\t\t\tvar buffer=buffers[i];\n\t\t\t\tif(buffer==null){//\u5DF2\u88AB\u4E3B\u52A8\u91CA\u653E\u5185\u5B58\uFF0C\u6BD4\u5982\u957F\u65F6\u95F4\u5B9E\u65F6\u4F20\u8F93\u5F55\u97F3\u65F6\n\t\t\t\t\thasClear=1;\n\t\t\t\t}else{\n\t\t\t\t\tnum+=buffer.length;\n\t\t\t\t\t\n\t\t\t\t\t//\u63A8\u5165\u540E\u53F0\u8FB9\u5F55\u8FB9\u8F6C\u7801\n\t\t\t\t\tif(engineCtx&&buffer.length){\n\t\t\t\t\t\tThis[set.type+\"_encode\"](engineCtx,buffer);\n\t\t\t\t\t};\n\t\t\t\t};\n\t\t\t};\n\t\t\t\n\t\t\t//\u540C\u6B65\u6E05\u7406This.buffers\uFF0C\u4E0D\u7BA1buffers\u5230\u5E95\u6E05\u4E86\u591A\u5C11\u4E2A\uFF0CbuffersThis\u662F\u4F7F\u7528\u4E0D\u5230\u7684\u8FDB\u884C\u5168\u6E05\n\t\t\tif(hasClear && engineCtx){\n\t\t\t\tvar i=bufferFirstIdxThis;\n\t\t\t\tif(buffersThis[0]){\n\t\t\t\t\ti=0;\n\t\t\t\t};\n\t\t\t\tfor(;i<bufferNextIdxThis;i++){\n\t\t\t\t\tbuffersThis[i]=null;\n\t\t\t\t};\n\t\t\t};\n\t\t\t\n\t\t\t//\u7EDF\u8BA1\u4FEE\u6539\u540E\u7684size\uFF0C\u5982\u679C\u5F02\u6B65\u53D1\u751Fclear\u8981\u539F\u6837\u52A0\u56DE\u6765\uFF0C\u540C\u6B65\u7684\u65E0\u9700\u64CD\u4F5C\n\t\t\tif(hasClear){\n\t\t\t\tnum=asyncBegin?addSize:0;\n\t\t\t\t\n\t\t\t\tbuffers[0]=null;//\u5F7B\u5E95\u88AB\u6E05\u7406\n\t\t\t};\n\t\t\tif(engineCtx){\n\t\t\t\tengineCtx.pcmSize+=num;\n\t\t\t}else{\n\t\t\t\tThis.recSize+=num;\n\t\t\t};\n\t\t};\n\t\t//\u5B9E\u65F6\u56DE\u8C03\u5904\u7406\u6570\u636E\uFF0C\u5141\u8BB8\u4FEE\u6539\u6216\u66FF\u6362\u4E0A\u6B21\u56DE\u8C03\u4EE5\u6765\u65B0\u589E\u7684\u6570\u636E \uFF0C\u4F46\u662F\u4E0D\u5141\u8BB8\u4FEE\u6539\u5DF2\u5904\u7406\u8FC7\u7684\uFF0C\u4E0D\u5141\u8BB8\u589E\u5220\u7B2C\u4E00\u7EF4\u6570\u7EC4 \uFF0C\u5141\u8BB8\u5C06\u7B2C\u4E8C\u7EF4\u6570\u7EC4\u4EFB\u610F\u4FEE\u6539\u66FF\u6362\u6210\u7A7A\u6570\u7EC4\u4E5F\u53EF\u4EE5\n\t\tvar asyncBegin=0,procTxt=\"rec.set.onProcess\";\n\t\ttry{\n\t\t\tasyncBegin=set.onProcess(buffers,powerLevel,duration,bufferSampleRate,bufferFirstIdx,asyncEnd);\n\t\t}catch(e){\n\t\t\t//\u6B64\u9519\u8BEF\u663E\u793A\u4E0D\u8981\u7528CLog\uFF0C\u8FD9\u6837\u63A7\u5236\u53F0\u5185\u76F8\u540C\u5185\u5BB9\u4E0D\u4F1A\u91CD\u590D\u6253\u5370\n\t\t\tconsole.error(procTxt+$T(\"gFUF::\u56DE\u8C03\u51FA\u9519\u662F\u4E0D\u5141\u8BB8\u7684\uFF0C\u9700\u4FDD\u8BC1\u4E0D\u4F1A\u629B\u5F02\u5E38\"),e);\n\t\t};\n\t\t\n\t\tvar slowT=Date.now()-now;\n\t\tif(slowT>10 && This.envInFirst-now>1000){ //1\u79D2\u540E\u5F00\u59CBonProcess\u6027\u80FD\u76D1\u6D4B\n\t\t\tThis.CLog(procTxt+$T(\"2ghS::\u4F4E\u6027\u80FD\uFF0C\u8017\u65F6{1}ms\",0,slowT),3);\n\t\t};\n\t\t\n\t\tif(asyncBegin===true){\n\t\t\t//\u5F00\u542F\u4E86\u5F02\u6B65\u6A21\u5F0F\uFF0ConProcess\u5DF2\u63A5\u7BA1buffers\u65B0\u6570\u636E\uFF0C\u7ACB\u5373\u6E05\u7A7A\uFF0C\u907F\u514D\u51FA\u73B0\u672A\u5904\u7406\u7684\u6570\u636E\n\t\t\tvar hasClear=0;\n\t\t\tfor(var i=bufferFirstIdx;i<bufferNextIdx;i++){\n\t\t\t\tif(buffers[i]==null){//\u5DF2\u88AB\u4E3B\u52A8\u91CA\u653E\u5185\u5B58\uFF0C\u6BD4\u5982\u957F\u65F6\u95F4\u5B9E\u65F6\u4F20\u8F93\u5F55\u97F3\u65F6 \uFF0C\u4F46\u53C8\u8981\u5F00\u542F\u5F02\u6B65\u6A21\u5F0F\uFF0C\u6B64\u79CD\u60C5\u51B5\u662F\u975E\u6CD5\u7684\n\t\t\t\t\thasClear=1;\n\t\t\t\t}else{\n\t\t\t\t\tbuffers[i]=new Int16Array(0);\n\t\t\t\t};\n\t\t\t};\n\t\t\t\n\t\t\tif(hasClear){\n\t\t\t\tThis.CLog($T(\"ufqH::\u672A\u8FDB\u5165\u5F02\u6B65\u524D\u4E0D\u80FD\u6E05\u9664buffers\"),3);\n\t\t\t}else{\n\t\t\t\t//\u8FD8\u539Fsize\uFF0C\u5F02\u6B65\u7ED3\u675F\u540E\u518D\u7EDF\u8BA1\u4EC5\u4FEE\u6539\u540E\u7684size\uFF0C\u5982\u679C\u53D1\u751Fclear\u8981\u539F\u6837\u52A0\u56DE\u6765\n\t\t\t\tif(engineCtx){\n\t\t\t\t\tengineCtx.pcmSize-=addSize;\n\t\t\t\t}else{\n\t\t\t\t\tThis.recSize-=addSize;\n\t\t\t\t};\n\t\t\t};\n\t\t}else{\n\t\t\tasyncEnd();\n\t\t};\n\t}\n\t\n\t\n\t\n\t\n\t//\u5F00\u59CB\u5F55\u97F3\uFF0C\u9700\u5148\u8C03\u7528open\uFF1B\u53EA\u8981open\u6210\u529F\u65F6\uFF0C\u8C03\u7528\u6B64\u65B9\u6CD5\u662F\u5B89\u5168\u7684\uFF0C\u5982\u679C\u672Aopen\u5F3A\u884C\u8C03\u7528\u5BFC\u81F4\u7684\u5185\u90E8\u9519\u8BEF\u5C06\u4E0D\u4F1A\u6709\u4EFB\u4F55\u63D0\u793A\uFF0Cstop\u65F6\u81EA\u7136\u80FD\u5F97\u5230\u9519\u8BEF\uFF1B\u6CE8\u610F\uFF1Aopen\u548Cstart\u81F3\u5C11\u6709\u4E00\u4E2A\u5E94\u5F53\u5728\u7528\u6237\u64CD\u4F5C\uFF08\u89E6\u6478\u3001\u70B9\u51FB\u7B49\uFF09\u4E0B\u8FDB\u884C\u8C03\u7528\uFF0C\u539F\u56E0\u53C2\u8003runningContext\u914D\u7F6E\n\t,start:function(){\n\t\tvar This=this;\n\t\t\n\t\tvar isOpen=1;\n\t\tif(This.set.sourceStream){//\u76F4\u63A5\u63D0\u4F9B\u4E86\u6D41\uFF0C\u4EC5\u5224\u65AD\u662F\u5426\u8C03\u7528\u4E86open\n\t\t\tif(!This.Stream){\n\t\t\t\tisOpen=0;\n\t\t\t}\n\t\t}else if(!Recorder.IsOpen()){//\u76D1\u6D4B\u5168\u5C40\u9EA6\u514B\u98CE\u662F\u5426\u6253\u5F00\u5E76\u4E14\u6709\u6548\n\t\t\tisOpen=0;\n\t\t};\n\t\tif(!isOpen){\n\t\t\tThis.CLog($T(\"6WmN::start\u5931\u8D25\uFF1A\u672Aopen\"),1);\n\t\t\treturn;\n\t\t};\n\t\tvar ctx=This._streamCtx();\n\t\tThis.CLog($T(\"kLDN::start \u5F00\u59CB\u5F55\u97F3\uFF0C\")+CtxState(ctx)+\" stream:\"+This._streamTag);\n\t\t\n\t\tThis._stop();\n\t\tThis.envStart(null, ctx[sampleRateTxt]);\n\t\tThis.state=3;//0\u672A\u5F55\u97F3 1\u5F55\u97F3\u4E2D 2\u6682\u505C 3\u7B49\u5F85ctx\u6FC0\u6D3B\n\t\t\n\t\t//\u68C0\u67E5open\u8FC7\u7A0B\u4E2Dstop\u662F\u5426\u5DF2\u7ECF\u8C03\u7528\u8FC7\n\t\tif(This._SO&&This._SO+1!=This._S){//\u4E0A\u9762\u8C03\u7528\u8FC7\u4E00\u6B21 _stop\n\t\t\t//open\u672A\u5B8C\u6210\u5C31\u8C03\u7528\u4E86stop\uFF0C\u6B64\u79CD\u60C5\u51B5\u7EC8\u6B62start\u3002\u4E5F\u5E94\u5C3D\u91CF\u907F\u514D\u51FA\u73B0\u6B64\u60C5\u51B5\n\t\t\tThis.CLog($T(\"Bp2y::start\u88AB\u4E2D\u65AD\"),3);\n\t\t\treturn;\n\t\t};\n\t\tThis._SO=0;\n\t\t\n\t\tvar end=function(){\n\t\t\tif(This.state==3){\n\t\t\t\tThis.state=1;\n\t\t\t\tThis.resume();\n\t\t\t}\n\t\t};\n\t\tvar tag=\"AudioContext resume: \";\n\t\tResumeCtx(ctx,function(runC){\n\t\t\trunC&&This.CLog(tag+\"wait...\");\n\t\t\treturn This.state==3;\n\t\t},function(runC){\n\t\t\trunC&&This.CLog(tag+ctx.state);\n\t\t\tend();\n\t\t},function(err){ //\u6BD4\u8F83\u5C11\u89C1\uFF0C\u53EF\u80FD\u5BF9\u5F55\u97F3\u6CA1\u6709\u5F71\u54CD\n\t\t\tThis.CLog(tag+ctx.state+$T(\"upkE::\uFF0C\u53EF\u80FD\u65E0\u6CD5\u5F55\u97F3\uFF1A\")+err,1);\n\t\t\tend();\n\t\t});\n\t}\n\t\n\t\n\t\n\t/*\u6682\u505C\u5F55\u97F3*/\n\t,pause:function(){\n\t\tvar This=this,stream=This._streamStore().Stream;\n\t\tif(This.state){\n\t\t\tThis.state=2;\n\t\t\tThis.CLog(\"pause\");\n\t\t\tif(stream) delete stream._call[This.id];\n\t\t};\n\t}\n\t/*\u6062\u590D\u5F55\u97F3*/\n\t,resume:function(){\n\t\tvar This=this,stream=This._streamStore().Stream;\n\t\tvar tag=\"resume\",tag3=tag+\"(wait ctx)\";\n\t\tif(This.state==3){ //start\u8FD8\u5728\u7B49ctx\u6062\u590D\n\t\t\tThis.CLog(tag3);\n\t\t}else if(This.state){\n\t\t\tThis.state=1;\n\t\t\tThis.CLog(tag);\n\t\t\tThis.envResume();\n\t\t\t\n\t\t\tif(stream){\n\t\t\t\tstream._call[This.id]=function(pcm,sum){\n\t\t\t\t\tif(This.state==1){\n\t\t\t\t\t\tThis.envIn(pcm,sum);\n\t\t\t\t\t};\n\t\t\t\t};\n\t\t\t\tConnAlive(stream);//AudioWorklet\u53EA\u4F1A\u5728ctx\u6FC0\u6D3B\u540E\u8FD0\u884C\n\t\t\t};\n\t\t\t\n\t\t\tvar ctx=This._streamCtx();\n\t\t\tif(ctx){ //AudioContext\u5982\u679C\u88AB\u6682\u505C\uFF0C\u5C3D\u91CF\u6062\u590D\n\t\t\t\tResumeCtx(ctx,function(runC){\n\t\t\t\t\trunC&&This.CLog(tag3+\"...\");\n\t\t\t\t\treturn This.state==1;\n\t\t\t\t},function(runC){\n\t\t\t\t\trunC&&This.CLog(tag3+ctx.state);\n\t\t\t\t\tConnAlive(stream);\n\t\t\t\t},function(err){\n\t\t\t\t\tThis.CLog(tag3+ctx.state+\"[err]\"+err,1);\n\t\t\t\t});\n\t\t\t};\n\t\t};\n\t}\n\t\n\t\n\t\n\t\n\t,_stop:function(keepEngine){\n\t\tvar This=this,set=This.set;\n\t\tif(!This.isMock){\n\t\t\tThis._S++;\n\t\t};\n\t\tif(This.state){\n\t\t\tThis.pause();\n\t\t\tThis.state=0;\n\t\t};\n\t\tif(!keepEngine && This[set.type+\"_stop\"]){\n\t\t\tThis[set.type+\"_stop\"](This.engineCtx);\n\t\t\tThis.engineCtx=0;\n\t\t};\n\t}\n\t/*\n\t\u7ED3\u675F\u5F55\u97F3\u5E76\u8FD4\u56DE\u5F55\u97F3\u6570\u636Eblob\u5BF9\u8C61\n\t\tTrue(blob,duration,mime)\n\t\t\tblob\uFF1A\u5F55\u97F3\u6570\u636Eaudio/mp3|wav\u683C\u5F0F\uFF1B\u9ED8\u8BA4\u662FBlob\u5BF9\u8C61\uFF0C\u53EF\u8BBE\u7F6Erec.dataType=\"arraybuffer\"\u6539\u6210ArrayBuffer\n\t\t\tduration\uFF1A\u5F55\u97F3\u65F6\u957F\uFF0C\u5355\u4F4D\u6BEB\u79D2\n\t\t\tmime\uFF1A\"auido/mp3\" blob\u6570\u636E\u7684\u7C7B\u578B\uFF0C\u65B9\u4FBFArrayBuffer\u65F6\u533A\u5206\u7C7B\u578B\n\t\tFalse(msg)\n\t\tautoClose:false \u53EF\u9009\uFF0C\u662F\u5426\u81EA\u52A8\u8C03\u7528close\uFF0C\u9ED8\u8BA4\u4E3Afalse\n\t*/\n\t,stop:function(True,False,autoClose){\n\t\tvar This=this,set=This.set,t1;\n\t\tvar envInMS=This.envInLast-This.envInFirst, envInLen=envInMS&&This.buffers.length; //\u53EF\u80FD\u672Astart\n\t\tThis.CLog($T(\"Xq4s::stop \u548Cstart\u65F6\u5DEE:\")\n\t\t\t+(envInMS?envInMS+\"ms \"+$T(\"3CQP::\u8865\u507F:\")+This.envInFix+\"ms\"\n\t\t\t\t+\" envIn:\"+envInLen+\" fps:\"+(envInLen/envInMS*1000).toFixed(1)\n\t\t\t:\"-\")+\" stream:\"+This._streamTag+\" (\"+GitUrl+\") LM:\"+LM);\n\t\t\n\t\tvar end=function(){\n\t\t\tThis._stop();//\u5F7B\u5E95\u5173\u6389engineCtx\n\t\t\tif(autoClose){\n\t\t\t\tThis.close();\n\t\t\t};\n\t\t};\n\t\tvar err=function(msg){\n\t\t\tThis.CLog($T(\"u8JG::\u7ED3\u675F\u5F55\u97F3\u5931\u8D25\uFF1A\")+msg,1);\n\t\t\tFalse&&False(msg);\n\t\t\tend();\n\t\t};\n\t\tvar ok=function(blob,mime,duration){\n\t\t\tvar tBlob=\"blob\",tABuf=\"arraybuffer\",tDT=\"dataType\",tDDT=\"DefaultDataType\";\n\t\t\tvar dType=This[tDT]||Recorder[tDDT]||tBlob,dTag=tDT+\"=\"+dType;\n\t\t\tvar isAB=blob instanceof ArrayBuffer,dErr=0;\n\t\t\tvar dLen=isAB?blob.byteLength:blob.size;\n\t\t\tif(dType==tABuf){\n\t\t\t\tif(!isAB) dErr=1;\n\t\t\t}else if(dType==tBlob){\n\t\t\t\tif(typeof Blob!=\"function\"){\n\t\t\t\t\tdErr=$T.G(\"NonBrowser-1\",[dTag])+$T(\"1skY::\uFF0C\u8BF7\u8BBE\u7F6E{1}\",0,RecTxt+\".\"+tDDT+'=\"'+tABuf+'\"');\n\t\t\t\t}else{\n\t\t\t\t\tif(isAB) blob=new Blob([blob],{type:mime});\n\t\t\t\t\tif(!(blob instanceof Blob)) dErr=1;\n\t\t\t\t\tmime=blob.type||mime;\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tdErr=$T.G(\"NotSupport-1\",[dTag]);\n\t\t\t};\n\t\t\t\n\t\t\tThis.CLog($T(\"Wv7l::\u7ED3\u675F\u5F55\u97F3 \u7F16\u7801\u82B1{1}ms \u97F3\u9891\u65F6\u957F{2}ms \u6587\u4EF6\u5927\u5C0F{3}b\",0,Date.now()-t1,duration,dLen)+\" \"+dTag+\",\"+mime);\n\t\t\tif(dErr){\n\t\t\t\terr(dErr!=1?dErr:$T(\"Vkbd::{1}\u7F16\u7801\u5668\u8FD4\u56DE\u7684\u4E0D\u662F{2}\",0,set.type,dType)+\", \"+dTag);\n\t\t\t\treturn;\n\t\t\t};\n\t\t\tif(set.takeoffEncodeChunk){//\u63A5\u7BA1\u4E86\u8F93\u51FA\uFF0C\u6B64\u65F6blob\u957F\u5EA6\u4E3A0\n\t\t\t\tThis.CLog($T(\"QWnr::\u542F\u7528takeoffEncodeChunk\u540Estop\u8FD4\u56DE\u7684blob\u957F\u5EA6\u4E3A0\u4E0D\u63D0\u4F9B\u97F3\u9891\u6570\u636E\"),3);\n\t\t\t}else if(dLen<Math.max(50,duration/5)){//1\u79D2\u5C0F\u4E8E0.2k\uFF1F\n\t\t\t\terr($T(\"Sz2H::\u751F\u6210\u7684{1}\u65E0\u6548\",0,set.type));\n\t\t\t\treturn;\n\t\t\t};\n\t\t\t\n\t\t\tTrue&&True(blob,duration,mime);\n\t\t\tend();\n\t\t};\n\t\tif(!This.isMock){\n\t\t\tvar isCtxWait=This.state==3;\n\t\t\tif(!This.state || isCtxWait){\n\t\t\t\terr($T(\"wf9t::\u672A\u5F00\u59CB\u5F55\u97F3\")+(isCtxWait?$T(\"Dl2c::\uFF0C\u5F00\u59CB\u5F55\u97F3\u524D\u65E0\u7528\u6237\u4EA4\u4E92\u5BFC\u81F4AudioContext\u672A\u8FD0\u884C\"):\"\"));\n\t\t\t\treturn;\n\t\t\t};\n\t\t};\n\t\tThis._stop(true); //\u5C06\u5F55\u97F3\u72B6\u6001\u6539\u6210\u672A\u5F55\u97F3\n\t\tvar size=This.recSize;\n\t\tif(!size){\n\t\t\terr($T(\"Ltz3::\u672A\u91C7\u96C6\u5230\u5F55\u97F3\"));\n\t\t\treturn;\n\t\t};\n\t\tif(!This[set.type]){\n\t\t\terr($T(\"xGuI::\u672A\u52A0\u8F7D{1}\u7F16\u7801\u5668\uFF0C\u8BF7\u5C1D\u8BD5\u5230{2}\u7684src/engine\u5185\u627E\u5230{1}\u7684\u7F16\u7801\u5668\u5E76\u52A0\u8F7D\",0,set.type,RecTxt));\n\t\t\treturn;\n\t\t};\n\t\t\n\t\t//\u73AF\u5883\u914D\u7F6E\u68C0\u67E5\uFF0C\u6B64\u5904\u4EC5\u9488\u5BF9mock\u8C03\u7528\uFF0C\u56E0\u4E3Aopen\u5DF2\u7ECF\u68C0\u67E5\u8FC7\u4E86\n\t\tif(This.isMock){\n\t\t\tvar checkMsg=This.envCheck(This.mockEnvInfo||{envName:\"mock\",canProcess:false});//\u6CA1\u6709\u63D0\u4F9B\u73AF\u5883\u4FE1\u606F\u7684mock\u65F6\u6CA1\u6709onProcess\u56DE\u8C03\n\t\t\tif(checkMsg){\n\t\t\t\terr($T(\"AxOH::\u5F55\u97F3\u9519\u8BEF\uFF1A\")+checkMsg);\n\t\t\t\treturn;\n\t\t\t};\n\t\t};\n\t\t\n\t\t//\u6B64\u7C7B\u578B\u6709\u8FB9\u5F55\u8FB9\u8F6C\u7801(Worker)\u652F\u6301\n\t\tvar engineCtx=This.engineCtx;\n\t\tif(This[set.type+\"_complete\"]&&engineCtx){\n\t\t\tvar duration=Math.round(engineCtx.pcmSize/set[sampleRateTxt]*1000);//\u91C7\u7528\u540E\u7684\u6570\u636E\u957F\u5EA6\u548Cbuffers\u7684\u957F\u5EA6\u53EF\u80FD\u5FAE\u5C0F\u7684\u4E0D\u4E00\u81F4\uFF0C\u662F\u91C7\u6837\u7387\u8FDE\u7EED\u8F6C\u6362\u7684\u7CBE\u5EA6\u95EE\u9898\n\t\t\t\n\t\t\tt1=Date.now();\n\t\t\tThis[set.type+\"_complete\"](engineCtx,function(blob,mime){\n\t\t\t\tok(blob,mime,duration);\n\t\t\t},err);\n\t\t\treturn;\n\t\t};\n\t\t\n\t\t//\u6807\u51C6UI\u7EBF\u7A0B\u8F6C\u7801\uFF0C\u8C03\u6574\u91C7\u6837\u7387\n\t\tt1=Date.now();\n\t\tif(!This.buffers[0]){\n\t\t\terr($T(\"xkKd::\u97F3\u9891buffers\u88AB\u91CA\u653E\"));\n\t\t\treturn;\n\t\t};\n\t\tvar chunk=Recorder.SampleData(This.buffers,This[srcSampleRateTxt],set[sampleRateTxt]);\n\t\t\n\t\tset[sampleRateTxt]=chunk[sampleRateTxt];\n\t\tvar res=chunk.data;\n\t\tvar duration=Math.round(res.length/set[sampleRateTxt]*1000);\n\t\t\n\t\tThis.CLog($T(\"CxeT::\u91C7\u6837:{1} \u82B1:{2}ms\",0,size+\"->\"+res.length,Date.now()-t1));\n\t\t\n\t\tsetTimeout(function(){\n\t\t\tt1=Date.now();\n\t\t\tThis[set.type](res,function(blob,mime){\n\t\t\t\tok(blob,mime,duration);\n\t\t\t},function(msg){\n\t\t\t\terr(msg);\n\t\t\t});\n\t\t});\n\t}\n\n};\n\n\n\n\n\n//=======\u4ECEWebM\u5B57\u8282\u6D41\u4E2D\u63D0\u53D6pcm\u6570\u636E\uFF0C\u63D0\u53D6\u6210\u529F\u8FD4\u56DEFloat32Array\uFF0C\u5931\u8D25\u8FD4\u56DEnull||-1=====\nvar WebM_Extract=function(inBytes, scope){\n\tif(!scope.pos){\n\t\tscope.pos=[0]; scope.tracks={}; scope.bytes=[];\n\t};\n\tvar tracks=scope.tracks, position=[scope.pos[0]];\n\tvar endPos=function(){ scope.pos[0]=position[0] };\n\t\n\tvar sBL=scope.bytes.length;\n\tvar bytes=new Uint8Array(sBL+inBytes.length);\n\tbytes.set(scope.bytes); bytes.set(inBytes,sBL);\n\tscope.bytes=bytes;\n\t\n\t//\u5148\u8BFB\u53D6\u6587\u4EF6\u5934\u548CTrack\u4FE1\u606F\n\tif(!scope._ht){\n\t\treadMatroskaVInt(bytes, position);//EBML Header\n\t\treadMatroskaBlock(bytes, position);//\u8DF3\u8FC7EBML Header\u5185\u5BB9\n\t\tif(!BytesEq(readMatroskaVInt(bytes, position), [0x18,0x53,0x80,0x67])){\n\t\t\treturn;//\u672A\u8BC6\u522B\u5230Segment\n\t\t}\n\t\treadMatroskaVInt(bytes, position);//\u8DF3\u8FC7Segment\u957F\u5EA6\u503C\n\t\twhile(position[0]<bytes.length){\n\t\t\tvar eid0=readMatroskaVInt(bytes, position);\n\t\t\tvar bytes0=readMatroskaBlock(bytes, position);\n\t\t\tvar pos0=[0],audioIdx=0;\n\t\t\tif(!bytes0)return;//\u6570\u636E\u4E0D\u5168\uFF0C\u7B49\u5F85\u7F13\u51B2\n\t\t\t//Track\u5B8C\u6574\u6570\u636E\uFF0C\u5FAA\u73AF\u8BFB\u53D6TrackEntry\n\t\t\tif(BytesEq(eid0, [0x16,0x54,0xAE,0x6B])){\n\t\t\t\twhile(pos0[0]<bytes0.length){\n\t\t\t\t\tvar eid1=readMatroskaVInt(bytes0, pos0);\n\t\t\t\t\tvar bytes1=readMatroskaBlock(bytes0, pos0);\n\t\t\t\t\tvar pos1=[0],track={channels:0,sampleRate:0};\n\t\t\t\t\tif(BytesEq(eid1, [0xAE])){//TrackEntry\n\t\t\t\t\t\twhile(pos1[0]<bytes1.length){\n\t\t\t\t\t\t\tvar eid2=readMatroskaVInt(bytes1, pos1);\n\t\t\t\t\t\t\tvar bytes2=readMatroskaBlock(bytes1, pos1);\n\t\t\t\t\t\t\tvar pos2=[0];\n\t\t\t\t\t\t\tif(BytesEq(eid2, [0xD7])){//Track Number\n\t\t\t\t\t\t\t\tvar val=BytesInt(bytes2);\n\t\t\t\t\t\t\t\ttrack.number=val;\n\t\t\t\t\t\t\t\ttracks[val]=track;\n\t\t\t\t\t\t\t}else if(BytesEq(eid2, [0x83])){//Track Type\n\t\t\t\t\t\t\t\tvar val=BytesInt(bytes2);\n\t\t\t\t\t\t\t\tif(val==1) track.type=\"video\";\n\t\t\t\t\t\t\t\telse if(val==2) {\n\t\t\t\t\t\t\t\t\ttrack.type=\"audio\";\n\t\t\t\t\t\t\t\t\tif(!audioIdx) scope.track0=track;\n\t\t\t\t\t\t\t\t\ttrack.idx=audioIdx++;\n\t\t\t\t\t\t\t\t}else track.type=\"Type-\"+val;\n\t\t\t\t\t\t\t}else if(BytesEq(eid2, [0x86])){//Track Codec\n\t\t\t\t\t\t\t\tvar str=\"\";\n\t\t\t\t\t\t\t\tfor(var i=0;i<bytes2.length;i++){\n\t\t\t\t\t\t\t\t\tstr+=String.fromCharCode(bytes2[i]);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\ttrack.codec=str;\n\t\t\t\t\t\t\t}else if(BytesEq(eid2, [0xE1])){\n\t\t\t\t\t\t\t\twhile(pos2[0]<bytes2.length){//\u5FAA\u73AF\u8BFB\u53D6 Audio \u5C5E\u6027\n\t\t\t\t\t\t\t\t\tvar eid3=readMatroskaVInt(bytes2, pos2);\n\t\t\t\t\t\t\t\t\tvar bytes3=readMatroskaBlock(bytes2, pos2);\n\t\t\t\t\t\t\t\t\t//\u91C7\u6837\u7387\u3001\u4F4D\u6570\u3001\u58F0\u9053\u6570\n\t\t\t\t\t\t\t\t\tif(BytesEq(eid3, [0xB5])){\n\t\t\t\t\t\t\t\t\t\tvar val=0,arr=new Uint8Array(bytes3.reverse()).buffer;\n\t\t\t\t\t\t\t\t\t\tif(bytes3.length==4) val=new Float32Array(arr)[0];\n\t\t\t\t\t\t\t\t\t\telse if(bytes3.length==8) val=new Float64Array(arr)[0];\n\t\t\t\t\t\t\t\t\t\telse CLog(\"WebM Track !Float\",1,bytes3);\n\t\t\t\t\t\t\t\t\t\ttrack[sampleRateTxt]=Math.round(val);\n\t\t\t\t\t\t\t\t\t}else if(BytesEq(eid3, [0x62,0x64])) track.bitDepth=BytesInt(bytes3);\n\t\t\t\t\t\t\t\t\telse if(BytesEq(eid3, [0x9F])) track.channels=BytesInt(bytes3);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tscope._ht=1;\n\t\t\t\tCLog(\"WebM Tracks\",tracks);\n\t\t\t\tendPos();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\t\n\t//\u6821\u9A8C\u97F3\u9891\u53C2\u6570\u4FE1\u606F\uFF0C\u5982\u679C\u4E0D\u7B26\u5408\u4EE3\u7801\u8981\u6C42\uFF0C\u7EDF\u7EDF\u62D2\u7EDD\u5904\u7406\n\tvar track0=scope.track0;\n\tif(!track0)return;\n\tif(track0.bitDepth==16 && /FLOAT/i.test(track0.codec)){\n\t\ttrack0.bitDepth=32; //chrome v66 \u5B9E\u9645\u4E3A\u6D6E\u70B9\u6570\n\t\tCLog(\"WebM 16->32 bit\",3);\n\t}\n\tif(track0[sampleRateTxt]!=scope[sampleRateTxt] || track0.bitDepth!=32 || track0.channels<1 || !/(\\b|_)PCM\\b/i.test(track0.codec)){\n\t\tscope.bytes=[];//\u683C\u5F0F\u975E\u9884\u671F \u65E0\u6CD5\u5904\u7406\uFF0C\u6E05\u7A7A\u7F13\u51B2\u6570\u636E\n\t\tif(!scope.bad)CLog(\"WebM Track Unexpected\",3,scope);\n\t\tscope.bad=1;\n\t\treturn -1;\n\t}\n\t\n\t//\u5FAA\u73AF\u8BFB\u53D6Cluster\u5185\u7684SimpleBlock\n\tvar datas=[],dataLen=0;\n\twhile(position[0]<bytes.length){\n\t\tvar eid1=readMatroskaVInt(bytes, position);\n\t\tvar bytes1=readMatroskaBlock(bytes, position);\n\t\tif(!bytes1)break;//\u6570\u636E\u4E0D\u5168\uFF0C\u7B49\u5F85\u7F13\u51B2\n\t\tif(BytesEq(eid1, [0xA3])){//SimpleBlock\u5B8C\u6574\u6570\u636E\n\t\t\tvar trackNo=bytes1[0]&0xf;\n\t\t\tvar track=tracks[trackNo];\n\t\t\tif(!track){//\u4E0D\u53EF\u80FD\u6CA1\u6709\uFF0C\u6570\u636E\u51FA\u9519\uFF1F\n\t\t\t\tCLog(\"WebM !Track\"+trackNo,1,tracks);\n\t\t\t}else if(track.idx===0){\n\t\t\t\tvar u8arr=new Uint8Array(bytes1.length-4);\n\t\t\t\tfor(var i=4;i<bytes1.length;i++){\n\t\t\t\t\tu8arr[i-4]=bytes1[i];\n\t\t\t\t}\n\t\t\t\tdatas.push(u8arr); dataLen+=u8arr.length;\n\t\t\t}\n\t\t}\n\t\tendPos();\n\t}\n\t\n\tif(dataLen){\n\t\tvar more=new Uint8Array(bytes.length-scope.pos[0]);\n\t\tmore.set(bytes.subarray(scope.pos[0]));\n\t\tscope.bytes=more; //\u6E05\u7406\u5DF2\u8BFB\u53D6\u4E86\u7684\u7F13\u51B2\u6570\u636E\n\t\tscope.pos[0]=0;\n\t\t\n\t\tvar u8arr=new Uint8Array(dataLen); //\u5DF2\u83B7\u53D6\u7684\u97F3\u9891\u6570\u636E\n\t\tfor(var i=0,i2=0;i<datas.length;i++){\n\t\t\tu8arr.set(datas[i],i2);\n\t\t\ti2+=datas[i].length;\n\t\t}\n\t\tvar arr=new Float32Array(u8arr.buffer);\n\t\t\n\t\tif(track0.channels>1){//\u591A\u58F0\u9053\uFF0C\u63D0\u53D6\u4E00\u4E2A\u58F0\u9053\n\t\t\tvar arr2=[];\n\t\t\tfor(var i=0;i<arr.length;){\n\t\t\t\tarr2.push(arr[i]);\n\t\t\t\ti+=track0.channels;\n\t\t\t}\n\t\t\tarr=new Float32Array(arr2);\n\t\t};\n\t\treturn arr;\n\t}\n};\n//\u4E24\u4E2A\u5B57\u8282\u6570\u7EC4\u5185\u5BB9\u662F\u5426\u76F8\u540C\nvar BytesEq=function(bytes1,bytes2){\n\tif(!bytes1 || bytes1.length!=bytes2.length) return false;\n\tif(bytes1.length==1) return bytes1[0]==bytes2[0];\n\tfor(var i=0;i<bytes1.length;i++){\n\t\tif(bytes1[i]!=bytes2[i]) return false;\n\t}\n\treturn true;\n};\n//\u5B57\u8282\u6570\u7EC4BE\u8F6C\u6210int\u6570\u5B57\nvar BytesInt=function(bytes){\n\tvar s=\"\";//0-8\u5B57\u8282\uFF0Cjs\u4F4D\u8FD0\u7B97\u53EA\u652F\u63014\u5B57\u8282\n\tfor(var i=0;i<bytes.length;i++){var n=bytes[i];s+=(n<16?\"0\":\"\")+n.toString(16)};\n\treturn parseInt(s,16)||0;\n};\n//\u8BFB\u53D6\u4E00\u4E2A\u53EF\u53D8\u957F\u6570\u503C\u5B57\u8282\u6570\u7EC4\nvar readMatroskaVInt=function(arr,pos,trim){\n\tvar i=pos[0];\n\tif(i>=arr.length)return;\n\tvar b0=arr[i],b2=(\"0000000\"+b0.toString(2)).substr(-8);\n\tvar m=/^(0*1)(\\d*)$/.exec(b2);\n\tif(!m)return;\n\tvar len=m[1].length, val=[];\n\tif(i+len>arr.length)return;\n\tfor(var i2=0;i2<len;i2++){ val[i2]=arr[i]; i++; }\n\tif(trim) val[0]=parseInt(m[2]||'0',2);\n\tpos[0]=i;\n\treturn val;\n};\n//\u8BFB\u53D6\u4E00\u4E2A\u81EA\u5E26\u957F\u5EA6\u7684\u5185\u5BB9\u5B57\u8282\u6570\u7EC4\nvar readMatroskaBlock=function(arr,pos){\n\tvar lenVal=readMatroskaVInt(arr,pos,1);\n\tif(!lenVal)return;\n\tvar len=BytesInt(lenVal);\n\tvar i=pos[0], val=[];\n\tif(len<0x7FFFFFFF){ //\u8D85\u5927\u503C\u4EE3\u8868\u6CA1\u6709\u957F\u5EA6\n\t\tif(i+len>arr.length)return;\n\t\tfor(var i2=0;i2<len;i2++){ val[i2]=arr[i]; i++; }\n\t}\n\tpos[0]=i;\n\treturn val;\n};\n//=====End WebM\u8BFB\u53D6=====\n\n\n//=====i18n \u7B80\u7248\u56FD\u9645\u5316\u591A\u8BED\u8A00\u652F\u6301=====\nvar i18n=Recorder.i18n={\n\tlang: \"zh-CN\" //\u9ED8\u8BA4\u4E2D\u6587\n\t,alias:{\"zh-CN\":\"zh\",\"en-US\":\"en\"} //\u522B\u540D\u914D\u7F6E\uFF0C\u6620\u5C04\u5230\u4E00\u4E2A\u8BED\u8A00\u5B9E\u4F8B\n\t,locales:{} //\u8BED\u8A00\u5B9E\u4F8B\uFF1Azh:{key:\"text\"}\n\t,data:{} //\u5404\u79CD\u6570\u636E\uFF0Cdesc$xx\uFF1A\u8BED\u8A00\u63CF\u8FF0\uFF0Crtl$xx\uFF1A\u6587\u672C\u65B9\u5411\u662F\u5426\u4ECE\u53F3\u5230\u5DE6 rtl$zh:false rtl$ar:true\n\t//\u6DFB\u52A0\u8BED\u8A00\u6587\u672C\u5185\u5BB9\uFF0Cset={lang:\"\",overwrite:true}\uFF0Ctexts=[\"key:text{1}\",...]\n\t,put:function(set,texts){\n\t\tvar tag=RecTxt+\".i18n.put: \";\n\t\tvar overwrite=set.overwrite; overwrite=overwrite==null||overwrite;\n\t\tvar lang=set.lang; lang=i18n.alias[lang]||lang;\n\t\tif(!lang)throw new Error(tag+\"set.lang?\");\n\t\tvar locale=i18n.locales[lang];\n\t\tif(!locale){ locale={}; i18n.locales[lang]=locale };\n\t\tvar exp=/^([\\w\\-]+):/,m;\n\t\tfor(var i=0;i<texts.length;i++){\n\t\t\tvar v=texts[i]; m=exp.exec(v);\n\t\t\tif(!m){ CLog(tag+\"'key:'? \"+v,3,set); continue }\n\t\t\tvar key=m[1],v=v.substr(key.length+1);\n\t\t\tif(!overwrite && locale[key]) continue;\n\t\t\tlocale[key]=v;\n\t\t}\n\t}\n\t//\u83B7\u53D6key\u5BF9\u5E94\u7684\u6587\u672C\uFF0C\u5982\u679C\u6CA1\u6709\u5BF9\u5E94\u6587\u672C\uFF0C\u5C06\u8FD4\u56DEen\u7684\uFF0Cen\u7684\u4E5F\u6CA1\u6709\u5C06\u8FD4\u56DEzh\u7684\n\t,get:function(/*key,args,lang*/){\n\t\treturn i18n.v_G.apply(null,arguments);\n\t}, v_G:function(key,args,lang){ //\u5168\u5C40\u53EF\u91CD\u5199get\n\t\targs=args||[];\n\t\tlang=lang||i18n.lang; lang=i18n.alias[lang]||lang;\n\t\tvar locale=i18n.locales[lang];\n\t\tvar val=locale&&locale[key]||\"\";\n\t\tif(!val&&lang!=\"zh\"){\n\t\t\tif(lang==\"en\")return i18n.v_G(key,args,\"zh\");\n\t\t\treturn i18n.v_G(key,args,\"en\");\n\t\t}\n\t\ti18n.lastLang=lang;\n\t\tif(val==\"=Empty\")return \"\";\n\t\treturn val.replace(/\\{(\\d+)(\\!?)\\}/g,function(v,a,b){\n\t\t\ta=+a||0; v=args[a-1];\n\t\t\tif(a<1 || a>args.length){ v=\"{?}\"; CLog(\"i18n[\"+key+\"] no {\"+a+\"}: \"+val,3) }\n\t\t\treturn b?\"\":v;\n\t\t});\n\t}\n\t/**\u8FD4\u56DE\u4E00\u4E2A\u56FD\u9645\u5316\u6587\u672C\uFF0C\u8FD4\u56DE\u7684\u6587\u672C\u53D6\u51B3\u4E8Ei18n.lang\u3002\n\t\t\u8C03\u7528\u53C2\u6570\uFF1AT(\"key:[lang]:\u4E2D\u6587{1}\",\"[lang]:\u82F1\u6587{1}\",...,0,\"args1\",\"args2\")\uFF0C\u9664\u4E86key:\uFF0C\u5176\u4ED6\u90FD\u662F\u53EF\u9009\u7684\uFF0C\u6587\u672C\u5982\u679C\u5728\u8BED\u8A00\u5B9E\u4F8B\u4E2D\u4E0D\u5B58\u5728\u4F1Apush\u8FDB\u53BB\uFF0C\u7B2C\u4E00\u4E2A\u6587\u672C\u65E0lang\u65F6\u9ED8\u8BA4zh\uFF0C\u7B2C\u4E8C\u4E2A\u65E0lang\u65F6\u9ED8\u8BA4en\uFF0C\u6587\u672C\u4E2D\u7528{1-n}\u6765\u63D2\u5165args\n\t\t\u7B2C\u4E00\u4E2Aargs\u524D\u9762\u8FD9\u4E2A\u53C2\u6570\u5FC5\u987B\u662F0\uFF1B\u4E5F\u53EF\u4EE5\u4E0D\u63D0\u4F9Bargs\uFF0C\u8FD9\u4E2A\u53C2\u6570\u586Bargs\u7684\u6570\u91CF\uFF0C\u6B64\u65F6\u4E0D\u8FD4\u56DE\u6587\u672C\uFF0C\u53EA\u8FD4\u56DEkey\uFF0C\u518D\u7528i18n.get\u63D0\u4F9B\u53C2\u6570\u83B7\u53D6\u6587\u672C\n\t\t\u672C\u51FD\u6570\u8C03\u7528\uFF0C\u7B2C\u4E00\u4E2A\u6587\u672C\u9700\u4E2D\u6587\uFF0C\u8C03\u7528\u5C3D\u91CF\u7B80\u5355\uFF0C\u4E0D\u8981\u6362\u884C\uFF0C\u65B9\u4FBF\u540E\u7EED\u81EA\u52A8\u63D0\u53D6\u7FFB\u8BD1\u5217\u8868\n\t\targs\u5982\u679C\u65E7\u7684\u53C2\u6570\u4F4D\u7F6E\u53D1\u751F\u4E86\u53D8\u66F4\uFF0C\u5E94\u5F53\u4F7F\u7528\u65B0\u7684key\uFF0C\u8BA9\u65E7\u7684\u7FFB\u8BD1\u5931\u6548\uFF0C\u589E\u52A0args\u65E0\u9700\u66F4\u6362key\n\t\tkey\u7684\u751F\u6210\u4F7F\u7528\u968F\u673A\u5B57\u7B26\u4E32\uFF0C\u4E0D\u540C\u6E90\u7801\u91CC\u9762\u53EF\u4EE5\u641E\u4E2A\u4E0D\u540C\u524D\u7F00:\n\t\t\ts=\"\";L=4; for(var i=0,n;i<L;i++){ n=~~(Math.random()*62);s+=n<10?n:String.fromCharCode(n<36?55+n:61+n); }; s\n\t**/\n\t,$T:function(){\n\t\treturn i18n.v_T.apply(null,arguments);\n\t} ,v_T:function(){ //\u5168\u5C40\u53EF\u91CD\u5199$T\n\t\tvar a=arguments,key=\"\",args=[],isArgs=0,tag=RecTxt+\".i18n.$T:\";\n\t\tvar exp=/^([\\w\\-]*):/,m;\n\t\tfor(var i=0;i<a.length;i++){\n\t\t\tvar v=a[i];\n\t\t\tif(i==0){\n\t\t\t\tm=exp.exec(v); key=m&&m[1];\n\t\t\t\tif(!key)throw new Error(tag+\"0 'key:'?\");\n\t\t\t\tv=v.substr(key.length+1);\n\t\t\t}\n\t\t\tif(isArgs===-1) args.push(v);\n\t\t\telse if(isArgs) throw new Error(tag+\" bad args\");\n\t\t\telse if(v===0) isArgs=-1;\n\t\t\telse if(IsNum(v)){\n\t\t\t\tif(v<1) throw new Error(tag+\" bad args\");\n\t\t\t\tisArgs=v;\n\t\t\t}else{\n\t\t\t\tvar lang=i==1?\"en\":i?\"\":\"zh\";\n\t\t\t\tm=exp.exec(v); if(m){ lang=m[1]||lang; v=v.substr(m[1].length+1); }\n\t\t\t\tif(!m || !lang)throw new Error(tag+i+\" 'lang:'?\");\n\t\t\t\ti18n.put({lang:lang,overwrite:false},[key+\":\"+v]);\n\t\t\t}\n\t\t}\n\t\tif(!key)return \"\";\n\t\tif(isArgs>0)return key;\n\t\treturn i18n.v_G(key,args);\n\t}\n};\nvar $T=i18n.$T; $T.G=i18n.get;\n//\u9884\u5B9A\u4E49\u6587\u672C\n$T(\"NonBrowser-1::\u975E\u6D4F\u89C8\u5668\u73AF\u5883\uFF0C\u4E0D\u652F\u6301{1}\",1);\n$T(\"IllegalArgs-1::\u53C2\u6570\u9519\u8BEF\uFF1A{1}\",1);\n$T(\"NeedImport-2::\u8C03\u7528{1}\u9700\u8981\u5148\u5BFC\u5165{2}\",2);\n$T(\"NotSupport-1::\u4E0D\u652F\u6301\uFF1A{1}\",1);\n//=====End i18n=====\n\n\n\n//\u6D41\u91CF\u7EDF\u8BA1\u75281\u50CF\u7D20\u56FE\u7247\u5730\u5740\uFF0C\u8BBE\u7F6E\u4E3A\u7A7A\u5C06\u4E0D\u53C2\u4E0E\u7EDF\u8BA1\nRecorder.TrafficImgUrl=\"//ia.51.la/go1?id=20469973&pvFlag=1\";\nvar Traffic=Recorder.Traffic=function(report){\n\tif(!isBrowser)return;\n\treport=report?\"/\"+RecTxt+\"/Report/\"+report:\"\";\n\tvar imgUrl=Recorder.TrafficImgUrl;\n\tif(imgUrl){\n\t\tvar data=Recorder.Traffic;\n\t\tvar m=/^(https?:..[^\\/#]*\\/?)[^#]*/i.exec(location.href)||[];\n\t\tvar host=(m[1]||\"http://file/\");\n\t\tvar idf=(m[0]||host)+report;\n\t\t\n\t\tif(imgUrl.indexOf(\"//\")==0){\n\t\t\t//\u7ED9url\u52A0\u4E0Ahttp\u524D\u7F00\uFF0C\u5982\u679C\u662Ffile\u534F\u8BAE\u4E0B\uFF0C\u4E0D\u52A0\u524D\u7F00\u6CA1\u6CD5\u7528\n\t\t\tif(/^https:/i.test(idf)){\n\t\t\t\timgUrl=\"https:\"+imgUrl;\n\t\t\t}else{\n\t\t\t\timgUrl=\"http:\"+imgUrl;\n\t\t\t};\n\t\t};\n\t\tif(report){\n\t\t\timgUrl=imgUrl+\"&cu=\"+encodeURIComponent(host+report);\n\t\t};\n\t\t\n\t\tif(!data[idf]){\n\t\t\tdata[idf]=1;\n\t\t\t\n\t\t\tvar img=new Image();\n\t\t\timg.src=imgUrl;\n\t\t\tCLog(\"Traffic Analysis Image: \"+(report||RecTxt+\".TrafficImgUrl=\"+Recorder.TrafficImgUrl));\n\t\t};\n\t};\n};\n\n\n\nif(WRec2){\n\tCLog($T(\"8HO5::\u8986\u76D6\u5BFC\u5165{1}\",0,RecTxt),1);\n\tWRec2.Destroy();\n};\nExport[RecTxt]=Recorder;\n\n}));", "export default require(\"./node_modules/recorder-core/src/recorder-core.js\");"],
  "mappings": "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",
  "names": []
}
